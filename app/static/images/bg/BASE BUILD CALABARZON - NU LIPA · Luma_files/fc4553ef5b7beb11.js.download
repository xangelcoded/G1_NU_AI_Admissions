(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,924792,274196,e=>{"use strict";e.s(["B",()=>_,"I",()=>x,"O",()=>c,"S",()=>G,"U",()=>u,"a",()=>f,"b",()=>s,"c",()=>z,"d",()=>J,"e",()=>d,"f",()=>K,"g",()=>H,"i",()=>v,"m",()=>g,"n",()=>M,"o",()=>V,"r",()=>R,"s",()=>D,"t",()=>T,"u",()=>I,"z",()=>b],924792);var t=e.i(191788);e.s(["ERROR_REVALIDATE_EVENT",()=>i,"FOCUS_EVENT",()=>r,"MUTATE_EVENT",()=>a,"RECONNECT_EVENT",()=>n],274196);let r=0,n=1,a=2,i=3;var l=Object.prototype.hasOwnProperty;let s=new WeakMap,o=()=>{},u=o(),c=Object,d=e=>e===u,f=e=>"function"==typeof e,g=(e,t)=>({...e,...t}),_=e=>f(e.then),h={},p={},m="undefined",v=typeof window!=m,y=typeof document!=m,E=v&&"Deno"in window,b=(e,t)=>{let r=s.get(e);return[()=>!d(t)&&e.get(t)||h,n=>{if(!d(t)){let a=e.get(t);t in p||(p[t]=a),r[5](t,g(a,n),a||h)}},r[6],()=>!d(t)&&t in p?p[t]:!d(t)&&e.get(t)||h]},w=!0,[S,C]=v&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[o,o],O={initFocus:e=>(y&&document.addEventListener("visibilitychange",e),S("focus",e),()=>{y&&document.removeEventListener("visibilitychange",e),C("focus",e)}),initReconnect:e=>{let t=()=>{w=!0,e()},r=()=>{w=!1};return S("online",t),S("offline",r),()=>{C("online",t),C("offline",r)}}},x=!t.default.useId,R=!v||E,T=e=>v&&typeof window.requestAnimationFrame!=m?window.requestAnimationFrame(e):setTimeout(e,1),I=R?t.useEffect:t.useLayoutEffect,k="undefined"!=typeof navigator&&navigator.connection,j=!R&&k&&(["slow-2g","2g"].includes(k.effectiveType)||k.saveData),N=new WeakMap,A=(e,t)=>e==="[object ".concat(t,"]"),L=0,P=e=>{let t,r,n=typeof e,a=c.prototype.toString.call(e),i=A(a,"Date"),l=A(a,"RegExp"),s=A(a,"Object");if(c(e)!==e||i||l)t=i?e.toJSON():"symbol"==n?e.toString():"string"==n?JSON.stringify(e):""+e;else{if(t=N.get(e))return t;if(t=++L+"~",N.set(e,t),Array.isArray(e)){for(r=0,t="@";r<e.length;r++)t+=P(e[r])+",";N.set(e,t)}if(s){t="#";let n=c.keys(e).sort();for(;!d(r=n.pop());)d(e[r])||(t+=r+":"+P(e[r])+",");N.set(e,t)}}return t},D=e=>{if(f(e))try{e=e()}catch(t){e=""}let t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?P(e):"",t]},U=0,V=()=>++U;async function M(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[n,i,l,o]=t,c=g({populateCache:!0,throwOnError:!0},"boolean"==typeof o?{revalidate:o}:o||{}),h=c.populateCache,p=c.rollbackOnError,m=c.optimisticData,v=c.throwOnError;if(f(i)){let e=[];for(let t of n.keys())!/^\$(inf|sub)\$/.test(t)&&i(n.get(t)._k)&&e.push(t);return Promise.all(e.map(y))}return y(i);async function y(e){let r,[i]=D(e);if(!i)return;let[o,g]=b(n,i),[y,E,w,S]=s.get(n),C=()=>{let t=y[i];return(f(c.revalidate)?c.revalidate(o().data,e):!1!==c.revalidate)&&(delete w[i],delete S[i],t&&t[0])?t[0](a).then(()=>o().data):o().data};if(t.length<3)return C();let O=l,x=!1,R=V();E[i]=[R,0];let T=!d(m),I=o(),k=I.data,j=I._c,N=d(j)?k:j;if(T&&g({data:m=f(m)?m(N,k):m,_c:N}),f(O))try{O=O(N)}catch(e){r=e,x=!0}if(O&&_(O)){let e;if(O=await O.catch(e=>{r=e,x=!0}),R!==E[i][0]){if(x)throw r;return O}x&&T&&(e=r,"function"==typeof p?p(e):!1!==p)&&(h=!0,g({data:N,_c:u}))}if(h&&!x&&(f(h)?g({data:h(O,N),error:u,_c:u}):g({data:O,error:u,_c:u})),E[i][1]=V(),Promise.resolve(C()).then(()=>{g({_c:u})}),x){if(v)throw r;return}return O}}let F=(e,t)=>{for(let r in e)e[r][0]&&e[r][0](t)},W=(e,t)=>{if(!s.has(e)){let a=g(O,t),i=Object.create(null),l=M.bind(u,e),c=o,d=Object.create(null),f=(e,t)=>{let r=d[e]||[];return d[e]=r,r.push(t),()=>r.splice(r.indexOf(t),1)},_=(t,r,n)=>{e.set(t,r);let a=d[t];if(a)for(let e of a)e(r,n)},h=()=>{if(!s.has(e)&&(s.set(e,[i,Object.create(null),Object.create(null),Object.create(null),l,_,f]),!R)){let t=a.initFocus(setTimeout.bind(u,F.bind(u,i,r))),l=a.initReconnect(setTimeout.bind(u,F.bind(u,i,n)));c=()=>{t&&t(),l&&l(),s.delete(e)}}};return h(),[e,l,h,c]}return[e,s.get(e)[4]]},[z,B]=W(new Map),J=g({onLoadingSlow:o,onSuccess:o,onError:o,onErrorRetry:(e,t,r,n,a)=>{let i=r.errorRetryCount,l=a.retryCount,s=~~((Math.random()+.5)*(1<<(l<8?l:8)))*r.errorRetryInterval;(d(i)||!(l>i))&&setTimeout(n,s,a)},onDiscarded:o,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:j?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:j?5e3:3e3,compare:function e(t,r){var n,a;if(t===r)return!0;if(t&&r&&(n=t.constructor)===r.constructor){if(n===Date)return t.getTime()===r.getTime();if(n===RegExp)return t.toString()===r.toString();if(n===Array){if((a=t.length)===r.length)for(;a--&&e(t[a],r[a]););return -1===a}if(!n||"object"==typeof t){for(n in a=0,t)if(l.call(t,n)&&++a&&!l.call(r,n)||!(n in r)||!e(t[n],r[n]))return!1;return Object.keys(r).length===a}}return t!=t&&r!=r},isPaused:()=>!1,cache:z,mutate:B,fallback:{}},{isOnline:()=>w,isVisible:()=>{let e=y&&document.visibilityState;return d(e)||"hidden"!==e}}),K=(e,t)=>{let r=g(e,t);if(t){let{use:n,fallback:a}=e,{use:i,fallback:l}=t;n&&i&&(r.use=n.concat(i)),a&&l&&(r.fallback=g(a,l))}return r},G=(0,t.createContext)({}),H=e=>{let{value:r}=e,n=(0,t.useContext)(G),a=f(r),i=(0,t.useMemo)(()=>a?r(n):r,[a,n,r]),l=(0,t.useMemo)(()=>a?i:K(n,i),[a,n,i]),s=i&&i.provider,o=(0,t.useRef)(u);s&&!o.current&&(o.current=W(s(l.cache||z),i));let c=o.current;return c&&(l.cache=c[0],l.mutate=c[1]),I(()=>{if(c)return c[2]&&c[2](),c[3]},[]),(0,t.createElement)(G.Provider,g(e,{value:l}))}},80784,789287,e=>{"use strict";e.s(["subscribeCallback",()=>c,"useSWRConfig",()=>s,"withArgs",()=>u,"withMiddleware",()=>d],80784);var t=e.i(924792);e.i(274196),e.s(["INFINITE_PREFIX",()=>r],789287);let r="$inf$";var n=e.i(191788);let a=t.i&&window.__SWR_DEVTOOLS_USE__,i=a?window.__SWR_DEVTOOLS_USE__:[],l=e=>(0,t.a)(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}],s=()=>{let e=(0,n.useContext)(t.S);return(0,n.useMemo)(()=>(0,t.m)(t.d,e),[e])},o=i.concat(e=>(n,a,i)=>{let l=a&&function(){for(var e=arguments.length,i=Array(e),l=0;l<e;l++)i[l]=arguments[l];let[s]=(0,t.s)(n),[,,,o]=t.b.get(t.c);if(s.startsWith(r))return a(...i);let u=o[s];return(0,t.e)(u)?a(...i):(delete o[s],u)};return e(n,l,i)}),u=e=>function(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];let i=s(),[u,c,d]=l(n),f=(0,t.f)(i,d),g=e,{use:_}=f,h=(_||[]).concat(o);for(let e=h.length;e--;)g=h[e](g);return g(u,c||f.fetcher||null,f)},c=(e,t,r)=>{let n=t[e]||(t[e]=[]);return n.push(r),()=>{let e=n.indexOf(r);e>=0&&(n[e]=n[n.length-1],n.pop())}},d=(e,t)=>function(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];let[i,s,o]=l(n),u=(o.use||[]).concat(t);return e(i,s,{...o,use:u})};a&&(window.__SWR_DEVTOOLS_REACT__=n.default)},322482,e=>{"use strict";e.s(["useRemoteData",()=>n]);var t=e.i(191788),r=e.i(672183);let n=e=>{let{fetcher:n,initialData:a}=e,[i,l]=(0,t.useState)({data:a||null,error:null}),s=(0,t.useCallback)(e=>{l({data:e,error:null})},[l]),o=async()=>{try{let e=await n();return l({data:e,error:null}),e}catch(e){throw l({data:null,error:e}),e}};return(0,r.useOnMount)(()=>{void 0===a&&o()}),{...i,refresh:o,setData:s}}},834300,e=>{"use strict";e.s(["UserSupportRole",()=>r,"UserTypes",()=>t]),e.i(821384).z.enum(["light","dark","system"]),function(e){e.PublicColumns=["api_id","avatar_url","bio_short","instagram_handle","last_online_at","linkedin_handle","name","tiktok_handle","timezone","twitter_handle","username","website","youtube_handle"],e.SelfInfoColumns=["api_id","apple_email","apple_user_id","avatar_url","bio_short","company","created_at","email_verified","email","eth_address","eth_ens_name","first_name","geo_city","geo_country","geo_region","google_contacts_sync_enabled","google_email","google_user_id","google_scopes","has_luma_chat_app","has_password","instagram_handle","is_admin","last_name","last_online_at","last_signed_in_at","linkedin_handle","locale","name","notification_preferences","personal_calendar_api_id","phone_number","preferred_theme","solana_address","stripe_customer_id","support_roles","tiktok_handle","timezone","twitter_handle","two_factor_auth_enforced","updated_at","username","website","youtube_handle","zoom_user_email","zoom_user_id","zoom_webinar_enabled"],e.UpdateColumns=["avatar_url","bio_short","first_name","instagram_handle","last_name","linkedin_handle","locale","name","preferred_theme","tiktok_handle","twitter_handle","username","website","youtube_handle"],e.MAX_NAME_LENGTH=60,e.MAX_BIO_LENGTH=140}(t||(t={}));var t,r=function(e){return e.Discover="discover",e.Polyjuice="polyjuice",e.Help="help",e.GalleryCurator="gallery_curator",e.Support="support",e}({})},317464,e=>{"use strict";e.s(["PolyjuiceBar",()=>o]);var t=e.i(391398),r=e.i(359626),n=e.i(203828),a=e.i(191788),i=e.i(876412),l=e.i(829900),s=e.i(348688);let o=()=>{let{user:e,refreshUser:o}=(0,l.useUserContext)(),u=(0,n.useRouter)(),[c,d]=(0,a.useState)(!1),f=async()=>{await s.APIClient.post("/admin/polyjuice/sign-out",{}),await u.push("/__admin"),await o(),window.location.reload()};return((0,a.useEffect)(()=>{d(!0)},[]),c&&e)?(0,t.jsxs)("div",{className:"jsx-e93145d6627dd887 bar",children:[(0,t.jsxs)("div",{className:"jsx-e93145d6627dd887 content fs-sm",children:[(0,t.jsxs)("div",{className:"jsx-e93145d6627dd887 email",children:[(0,t.jsx)(i.LuxCopy,{text:e.api_id,children:(0,t.jsx)("span",{className:"jsx-e93145d6627dd887",children:e.api_id})})," ","-"," ",(0,t.jsx)(i.LuxCopy,{text:e.email,children:(0,t.jsx)("span",{className:"jsx-e93145d6627dd887",children:e.email})})]}),(0,t.jsx)("div",{onClick:f,className:"jsx-e93145d6627dd887 a sign-out",children:"Sign Out"})]}),(0,t.jsx)(r.default,{id:"e93145d6627dd887",children:".bar.jsx-e93145d6627dd887{-webkit-backdrop-filter:blur(16px);backdrop-filter:blur(16px);text-align:center;z-index:1000;border-bottom-left-radius:var(--border-radius);background-color:rgba(236,102,13,.533);justify-content:center;min-height:10px;padding:.125rem .5rem;display:flex;position:fixed;top:0;right:0}.content.jsx-e93145d6627dd887{display:flex}.content.jsx-e93145d6627dd887 .sign-out.jsx-e93145d6627dd887{margin-left:1rem}"})]}):null}},760121,(e,t,r)=>{"use strict";var n=e.r(191788),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=n.useState,l=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function u(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!a(e,r)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),n=i({inst:{value:r,getSnapshot:t}}),a=n[0].inst,c=n[1];return s(function(){a.value=r,a.getSnapshot=t,u(a)&&c({inst:a})},[e,r,t]),l(function(){return u(a)&&c({inst:a}),e(function(){u(a)&&c({inst:a})})},[e]),o(r),r};r.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:c},890979,(e,t,r)=>{"use strict";t.exports=e.r(760121)},463905,250508,861298,430964,e=>{"use strict";e.s(["UNDEFINED",()=>t.U],463905);var t=e.i(924792);e.s(["OBJECT",()=>r.O],250508);var r=t;e.s(["SWRConfig",()=>n.g],861298);var n=t;e.s(["defaultConfig",()=>a.d],430964);var a=t},950323,184940,396069,599404,934659,814451,962521,e=>{"use strict";e.s(["default",()=>R],950323);var t=e.i(191788),r=e.i(890979),n=e.i(463905),a=e.i(250508),i=e.i(861298),l=e.i(430964),s=e.i(80784);e.s(["SWRGlobalState",()=>o.b],184940);var o=e.i(924792),o=o;e.s(["serialize",()=>u.s],396069);var u=o;e.s(["createCacheHelper",()=>c.z],599404);var c=o;e.s(["isUndefined",()=>d.e],934659);var d=o,f=o,g=o;e.s(["isFunction",()=>_.a],814451);var _=o,h=e.i(274196),h=h,p=o;e.s(["useIsomorphicLayoutEffect",()=>m.u],962521);var m=o,v=o,y=o,E=o,b=o;let w=()=>{},S=w();new WeakMap;let C=t.default.use||(e=>{switch(e.status){case"pending":throw e;case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e}}),O={dedupe:!0},x=Promise.resolve(n.UNDEFINED);a.OBJECT.defineProperty(i.SWRConfig,"defaultValue",{value:l.defaultConfig});let R=(0,s.withArgs)((e,a,i)=>{let{cache:l,compare:w,suspense:S,fallbackData:R,revalidateOnMount:T,revalidateIfStale:I,refreshInterval:k,refreshWhenHidden:j,refreshWhenOffline:N,keepPreviousData:A}=i,[L,P,D,U]=o.b.get(l),[V,M]=(0,u.s)(e),F=(0,t.useRef)(!1),W=(0,t.useRef)(!1),z=(0,t.useRef)(V),B=(0,t.useRef)(a),J=(0,t.useRef)(i),K=()=>J.current.isVisible()&&J.current.isOnline(),[G,H,$,q]=(0,c.z)(l,V),X=(0,t.useRef)({}).current,Y=(0,d.e)(R)?(0,d.e)(i.fallback)?n.UNDEFINED:i.fallback[V]:R,Q=(e,t)=>{for(let r in X)if("data"===r){if(!w(e[r],t[r])&&(!(0,d.e)(e[r])||!w(es,t[r])))return!1}else if(t[r]!==e[r])return!1;return!0},Z=(0,t.useMemo)(()=>{let e=!!V&&!!a&&((0,d.e)(T)?!J.current.isPaused()&&!S&&!1!==I:T),t=t=>{let r=(0,b.m)(t);return(delete r._k,e)?{isValidating:!0,isLoading:!0,...r}:r},r=G(),n=q(),i=t(r),l=r===n?i:t(n),s=i;return[()=>{let e=t(G());return Q(e,s)?(s.data=e.data,s.isLoading=e.isLoading,s.isValidating=e.isValidating,s.error=e.error,s):(s=e,e)},()=>l]},[l,V]),ee=(0,r.useSyncExternalStore)((0,t.useCallback)(e=>$(V,(t,r)=>{Q(r,t)||e()}),[l,V]),Z[0],Z[1]),et=!F.current,er=L[V]&&L[V].length>0,en=ee.data,ea=(0,d.e)(en)?Y&&(0,f.B)(Y)?C(Y):Y:en,ei=ee.error,el=(0,t.useRef)(ea),es=A?(0,d.e)(en)?(0,d.e)(el.current)?ea:el.current:en:ea,eo=(!er||!!(0,d.e)(ei))&&(et&&!(0,d.e)(T)?T:!J.current.isPaused()&&(S?!(0,d.e)(ea)&&I:(0,d.e)(ea)||I)),eu=!!(V&&a&&et&&eo),ec=(0,d.e)(ee.isValidating)?eu:ee.isValidating,ed=(0,d.e)(ee.isLoading)?eu:ee.isLoading,ef=(0,t.useCallback)(async e=>{let t,r,a=B.current;if(!V||!a||W.current||J.current.isPaused())return!1;let l=!0,s=e||{},o=!D[V]||!s.dedupe,u=()=>E.I?!W.current&&V===z.current&&F.current:V===z.current,c={isValidating:!1,isLoading:!1},f=()=>{H(c)},p=()=>{let e=D[V];e&&e[1]===r&&delete D[V]},m={isValidating:!0};(0,d.e)(G().data)&&(m.isLoading=!0);try{if(o&&(H(m),i.loadingTimeout&&(0,d.e)(G().data)&&setTimeout(()=>{l&&u()&&J.current.onLoadingSlow(V,i)},i.loadingTimeout),D[V]=[a(M),(0,g.o)()]),[t,r]=D[V],t=await t,o&&setTimeout(p,i.dedupingInterval),!D[V]||D[V][1]!==r)return o&&u()&&J.current.onDiscarded(V),!1;c.error=n.UNDEFINED;let e=P[V];if(!(0,d.e)(e)&&(r<=e[0]||r<=e[1]||0===e[1]))return f(),o&&u()&&J.current.onDiscarded(V),!1;let s=G().data;c.data=w(s,t)?s:t,o&&u()&&J.current.onSuccess(t,V,i)}catch(r){p();let e=J.current,{shouldRetryOnError:t}=e;!e.isPaused()&&(c.error=r,o&&u()&&(e.onError(r,V,e),(!0===t||(0,_.a)(t)&&t(r))&&(!J.current.revalidateOnFocus||!J.current.revalidateOnReconnect||K())&&e.onErrorRetry(r,V,e,e=>{let t=L[V];t&&t[0]&&t[0](h.ERROR_REVALIDATE_EVENT,e)},{retryCount:(s.retryCount||0)+1,dedupe:!0})))}return l=!1,f(),!0},[V,l]),eg=(0,t.useCallback)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,p.n)(l,z.current,...t)},[]);if((0,m.u)(()=>{B.current=a,J.current=i,(0,d.e)(en)||(el.current=en)}),(0,m.u)(()=>{if(!V)return;let e=ef.bind(n.UNDEFINED,O),t=0;J.current.revalidateOnFocus&&(t=Date.now()+J.current.focusThrottleInterval);let r=(0,s.subscribeCallback)(V,L,function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r==h.FOCUS_EVENT){let r=Date.now();J.current.revalidateOnFocus&&r>t&&K()&&(t=r+J.current.focusThrottleInterval,e())}else if(r==h.RECONNECT_EVENT)J.current.revalidateOnReconnect&&K()&&e();else if(r==h.MUTATE_EVENT)return ef();else if(r==h.ERROR_REVALIDATE_EVENT)return ef(n)});return W.current=!1,z.current=V,F.current=!0,H({_k:M}),eo&&!D[V]&&((0,d.e)(ea)||v.r?e():(0,y.t)(e)),()=>{W.current=!0,r()}},[V]),(0,m.u)(()=>{let e;function t(){let t=(0,_.a)(k)?k(G().data):k;t&&-1!==e&&(e=setTimeout(r,t))}function r(){!G().error&&(j||J.current.isVisible())&&(N||J.current.isOnline())?ef(O).then(t):t()}return t(),()=>{e&&(clearTimeout(e),e=-1)}},[k,j,N,V]),(0,t.useDebugValue)(es),S){let e=V&&(0,d.e)(ea);if(!E.I&&v.r&&e)throw Error("Fallback data is required when using Suspense in SSR.");e&&(B.current=a,J.current=i,W.current=!1);let t=U[V];if(C(!(0,d.e)(t)&&e?eg(t):x),!(0,d.e)(ei)&&e)throw ei;let r=e?ef(O):x;!(0,d.e)(es)&&e&&(r.status="fulfilled",r.value=!0),C(r)}return{mutate:eg,get data(){return X.data=!0,es},get error(){return X.error=!0,ei},get isValidating(){return X.isValidating=!0,ec},get isLoading(){return X.isLoading=!0,ed}}})},581254,e=>{"use strict";e.s(["useAPI",()=>i,"useAPIPost",()=>l]);var t=e.i(191788),r=e.i(950323),n=e.i(348688),a=e.i(829900);let i=e=>{let{path:i,pause:l,args:s,swrConfig:o,additionalKey:u}=e,c=(0,t.useContext)(a.UserContext),d=null==c?void 0:c.user,f=[(null==d?void 0:d.api_id)||"anonymous",i,JSON.stringify(s)];u&&f.push(u);let{data:g,error:_,mutate:h}=(0,r.default)(l?null:f,()=>n.APIClient.get(i,s),o),p=(0,t.useCallback)(async()=>{await h()},[h]);return{data:g,error:_,mutate:h,refresh:p}},l=e=>{let{path:t,pause:i,body:l,swrConfig:s,additionalKey:o}=e,{user:u}=(0,a.useUserContext)(),c=[(null==u?void 0:u.api_id)||"anonymous",t,JSON.stringify(l)];o&&c.push(o);let{data:d,error:f,mutate:g,isLoading:_}=(0,r.default)(i?null:c,()=>n.APIClient.post(t,l),s);return{data:d,error:f,mutate:g,isLoading:_}}},829900,149230,32021,e=>{"use strict";e.s(["UserContext",()=>E,"UserProvider",()=>C,"useUserContext",()=>O],829900),e.i(350461);var t,r,n=e.i(391398),a=e.i(275885),i=e.i(982725),l=e.i(191788),s=e.i(80784),o=e.i(824015),u=e.i(645935),c=e.i(322482),d=e.i(602533),f=e.i(851800),g=e.i(109001),_=e.i(675389),h=e.i(834300),p=e.i(317464),m=e.i(581254);e.s(["UserLocalStorage",()=>r,"useUserLocalStorage",()=>v],32021),e.s(["LocalStorage",()=>t],149230),function(e){e.get=function(e){let{key:t,schema:r}=e;try{if(!window.localStorage)return null;let e=localStorage.getItem(t);if(!e)return null;return r.parse(JSON.parse(e))}catch(e){console.error(e)}return null},e.save=function(e){let{key:t,value:r,schema:n}=e;try{if(!window.localStorage)return;n.parse(r);let e=JSON.stringify(r);localStorage.setItem(t,e)}catch(e){console.error(e)}},e.filterEntries=function(e){if(!window.localStorage)return;let t=[];for(let e=0;e<localStorage.length;e+=1){let r=localStorage.key(e);r&&t.push(r)}for(let r of t)e(r)||localStorage.removeItem(r)}}(t||(t={})),function(e){let r="luma.user-storage.";e.createKey=e=>{let{user_api_id:t,key:n}=e;return["".concat(r).concat(t,"."),n].join("")},e.clear=()=>t.filterEntries(e=>!e.startsWith(r))}(r||(r={}));let v=()=>{let{user:e}=O();if(!e)return null;let n=e.api_id;return(0,l.useMemo)(()=>({get:e=>{let{key:a,schema:i}=e;return t.get({key:r.createKey({user_api_id:n,key:a}),schema:i})},save:e=>{let{key:a,value:i,schema:l}=e;return t.save({key:r.createKey({user_api_id:n,key:a}),value:i,schema:l})}}),[n])};var y=e.i(348688);let E=(0,l.createContext)(null),b="sign-in",w="sign-out",S="undefined"!=typeof BroadcastChannel?new BroadcastChannel("auth_channel"):null,C=e=>{var t;let{initialUserData:d,children:v}=e,{setLocale:C}=(0,f.useLocalizationContext)(),[O,x]=(0,l.useState)(!!i.default.get(_.POLYJUICE_SIGN_IN_STATE_COOKIE)),{data:R,refresh:T,setData:I}=(0,c.useRemoteData)({fetcher:()=>y.APIClient.get("/user"),initialData:d||null}),k=(null==R?void 0:R.user)||null,j=(0,l.useCallback)(e=>{let{user:t}=e;t.locale&&C(t.locale),I({user:t});try{null==S||S.postMessage(b)}catch(e){console.error(e)}},[I,C]),{data:N,refresh:A}=(0,m.useAPI)({path:"/calendar/admin/list",args:{},pause:!k}),L=(0,l.useMemo)(()=>{var e;return null!=(e=null==N?void 0:N.infos)?e:[]},[null==N?void 0:N.infos]),P=!N,{setUserLightness:D}=(0,l.useContext)(o.LightnessContext),U=(null==k?void 0:k.preferred_theme)||"system";(0,l.useEffect)(()=>{D("system"===U?null:U)},[U,D]),(0,l.useEffect)(()=>{if(k){let{api_id:e,email:t}=k;a.setUser({id:e,email:t})}},[k,O,L]);let V=(0,l.useCallback)(()=>{I(null),a.setUser(null)},[I]);(0,u.usePolling)(()=>{let e=!!i.default.get(_.POLYJUICE_SIGN_IN_STATE_COOKIE);e!==O&&T(),x(e)},500);let{mutate:M}=(0,s.useSWRConfig)(),F=(0,l.useCallback)(async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];try{await y.APIClient.post("/auth/sign-out")}catch(e){}V(),M(e=>!0,void 0,!1),r.clear(),e&&(null==S||S.postMessage(w))},[V,M]);(0,u.usePolling)(async()=>{if(document.hasFocus()&&k&&!O)try{await y.APIClient.post("/user/ping",{is_online_chat:!0})}catch(e){e instanceof g.FetchError&&401===e.status&&await F(!1)}},{seconds:30},{runOnMount:!0}),(0,l.useEffect)(()=>{let e=async function(e){e.data===w?await F(!1):e.data===b&&await T()};return null==S||S.addEventListener("message",e),()=>{null==S||S.removeEventListener("message",e)}},[F,T]);let W=!!((null==k?void 0:k.is_admin)||(null==k||null==(t=k.support_roles)?void 0:t.includes(h.UserSupportRole.Support))),z=(0,l.useMemo)(()=>{let e=W||!1;return{chatVideoMessages:e,passkeyAuthentication:e}},[W]),B=(0,l.useCallback)(async e=>{I({user:e})},[I]);return(0,n.jsxs)(E.Provider,{value:{user:k,signIn:j,calendarInfos:L,calendarsLoading:P,refreshUser:T,setUser:B,onSignIn:T,isPolyjuiced:O,refreshCalendars:A,signOut:F,featureFlags:z,isSupportAdmin:W},children:[O&&(0,n.jsx)(p.PolyjuiceBar,{}),v]})},O=(0,d.createUseAppContext)(E)}]);