(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,179281,t=>{"use strict";t.s(["SIWXUtil",()=>rj],179281),t.i(221168),t.i(350461);var e=t.i(679753);t.i(835588),t.i(829432),t.i(513582),t.i(319592),t.i(755153);var r=t.i(211902),n=Object.defineProperty;r.IEvents,r.IEvents,r.IEvents,r.IEvents,r.IEvents,r.IEvents,e.default,e.EventEmitter;var i=t.i(711790);t.i(712314),t.i(77755),t.i(602016),t.i(744934),t.i(386736);var o=t.i(604785);let s=BigInt(0x100000000-1),a=BigInt(32);var l=t.i(15137);let h=[],f=[],c=[],u=BigInt(0),d=BigInt(1),p=BigInt(2),g=BigInt(7),y=BigInt(256),b=BigInt(113);for(let t=0,e=d,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],h.push(2*(5*n+r)),f.push((t+1)*(t+2)/2%64);let i=u;for(let t=0;t<7;t++)(e=(e<<d^(e>>g)*b)%y)&p&&(i^=d<<(d<<BigInt(t))-d);c.push(i)}let[w,m]=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l}=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?{h:Number(t&s),l:Number(t>>a&s)}:{h:0|Number(t>>a&s),l:0|Number(t&s)}}(t[i],e);[r[i],n[i]]=[o,l]}return[r,n]}(c,!0),E=(t,e,r)=>r>32?((t,e,r)=>e<<r-32|t>>>64-r)(t,e,r):((t,e,r)=>t<<r|e>>>32-r)(t,e,r),x=(t,e,r)=>r>32?((t,e,r)=>t<<r-32|e>>>64-r)(t,e,r):((t,e,r)=>e<<r|t>>>32-r)(t,e,r);class v extends l.Hash{keccak(){l.isLE||(0,l.byteSwap32)(this.state32),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){let n=(e+8)%10,i=(e+2)%10,o=r[i],s=r[i+1],a=E(o,s,1)^r[n],l=x(o,s,1)^r[n+1];for(let r=0;r<50;r+=10)t[e+r]^=a,t[e+r+1]^=l}let e=t[2],i=t[3];for(let r=0;r<24;r++){let n=f[r],o=E(e,i,n),s=x(e,i,n),a=h[r];e=t[a],i=t[a+1],t[a]=o,t[a+1]=s}for(let e=0;e<50;e+=10){for(let n=0;n<10;n++)r[n]=t[e+n];for(let n=0;n<10;n++)t[e+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=w[n],t[1]^=m[n]}r.fill(0)}(this.state32,this.rounds),l.isLE||(0,l.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(t){(0,o.aexists)(this);let{blockLen:e,state:r}=this,n=(t=(0,l.toBytes)(t)).length;for(let i=0;i<n;){let o=Math.min(e-this.pos,n-i);for(let e=0;e<o;e++)r[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,(128&e)!=0&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){(0,o.aexists)(this,!1),(0,o.abytes)(t),this.finish();let e=this.state,{blockLen:r}=this;for(let n=0,i=t.length;n<i;){this.posOut>=r&&this.keccak();let o=Math.min(r-this.posOut,i-n);t.set(e.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,o.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,o.aoutput)(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:e,suffix:r,outputLen:n,rounds:i,enableXOF:o}=this;return t||(t=new v(e,r,n,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=n,t.enableXOF=o,t.destroyed=this.destroyed,t}constructor(t,e,r,n=!1,i=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,o.anumber)(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,l.u32)(this.state)}}function O(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, got "+t)}function A(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if(!(t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name))throw Error("Uint8Array expected");if(r.length>0&&!r.includes(t.length))throw Error("Uint8Array expected of length "+r+", got length="+t.length)}function I(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function S(t,e){A(t);let r=e.outputLen;if(t.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}t.i(841583),t.i(73730),t.i(187978),t.i(513011),t.i(737640),t.i(848522),Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let B=BigInt(0x100000000-1),U=BigInt(32),C="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function N(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function _(t,e){return t<<32-e|t>>>e}let P=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function L(t){for(let r=0;r<t.length;r++){var e;t[r]=(e=t[r])<<24&0xff000000|e<<8&0xff0000|e>>>8&65280|e>>>24&255}}function j(t){return"string"==typeof t&&(t=function(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}(t)),A(t),t}class k{clone(){return this._cloneInto()}}function T(t){let e=e=>t().update(j(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function R(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(C&&"function"==typeof C.getRandomValues)return C.getRandomValues(new Uint8Array(t));if(C&&"function"==typeof C.randomBytes)return C.randomBytes(t);throw Error("crypto.getRandomValues must be defined")}let H=[],z=[],F=[],D=BigInt(0),q=BigInt(1),M=BigInt(2),V=BigInt(7),W=BigInt(256),X=BigInt(113);for(let t=0,e=q,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],H.push(2*(5*n+r)),z.push((t+1)*(t+2)/2%64);let i=D;for(let t=0;t<7;t++)(e=(e<<q^(e>>V)*X)%W)&M&&(i^=q<<(q<<BigInt(t))-q);F.push(i)}let[Y,Z]=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l:s}=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?{h:Number(t&B),l:Number(t>>U&B)}:{h:0|Number(t>>U&B),l:0|Number(t&B)}}(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]}(F,!0),K=(t,e,r)=>r>32?((t,e,r)=>e<<r-32|t>>>64-r)(t,e,r):((t,e,r)=>t<<r|e>>>32-r)(t,e,r),G=(t,e,r)=>r>32?((t,e,r)=>t<<r-32|e>>>64-r)(t,e,r):((t,e,r)=>e<<r|t>>>32-r)(t,e,r);class J extends k{keccak(){P||L(this.state32),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){let n=(e+8)%10,i=(e+2)%10,o=r[i],s=r[i+1],a=K(o,s,1)^r[n],l=G(o,s,1)^r[n+1];for(let r=0;r<50;r+=10)t[e+r]^=a,t[e+r+1]^=l}let e=t[2],i=t[3];for(let r=0;r<24;r++){let n=z[r],o=K(e,i,n),s=G(e,i,n),a=H[r];e=t[a],i=t[a+1],t[a]=o,t[a+1]=s}for(let e=0;e<50;e+=10){for(let n=0;n<10;n++)r[n]=t[e+n];for(let n=0;n<10;n++)t[e+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=Y[n],t[1]^=Z[n]}r.fill(0)}(this.state32,this.rounds),P||L(this.state32),this.posOut=0,this.pos=0}update(t){I(this);let{blockLen:e,state:r}=this,n=(t=j(t)).length;for(let i=0;i<n;){let o=Math.min(e-this.pos,n-i);for(let e=0;e<o;e++)r[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,(128&e)!=0&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){I(this,!1),A(t),this.finish();let e=this.state,{blockLen:r}=this;for(let n=0,i=t.length;n<i;){this.posOut>=r&&this.keccak();let o=Math.min(r-this.posOut,i-n);t.set(e.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return O(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(S(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:e,suffix:r,outputLen:n,rounds:i,enableXOF:o}=this;return t||(t=new J(e,r,n,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=n,t.enableXOF=o,t.destroyed=this.destroyed,t}constructor(t,e,r,n=!1,i=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,O(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=function(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}(this.state)}}function Q(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, got "+t)}function $(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function tt(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if(!$(t))throw Error("Uint8Array expected");if(r.length>0&&!r.includes(t.length))throw Error("Uint8Array expected of length "+r+", got length="+t.length)}function te(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function tr(t){if("boolean"!=typeof t)throw Error("boolean expected, not ".concat(t))}T(()=>new J(136,1,32)),Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let tn=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));if(68!==new Uint8Array(new Uint32Array([0x11223344]).buffer)[0])throw Error("Non little-endian hardware is not supported");function ti(t){if("string"==typeof t)t=function(t){if("string"!=typeof t)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}(t);else if($(t))t=ta(t);else throw Error("Uint8Array expected, got "+typeof t);return t}function to(t,e){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(void 0===e)return new Uint8Array(t);if(e.length!==t)throw Error("invalid output length, expected "+t+", got: "+e.length);if(r&&e.byteOffset%4!=0)throw Error("invalid output, must be aligned");return e}function ts(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>i&o),a=Number(r&o),l=4*!!n,h=4*!n;t.setUint32(e+l,s,n),t.setUint32(e+h,a,n)}function ta(t){return Uint8Array.from(t)}function tl(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];for(let t=0;t<e.length;t++)e[t].fill(0)}let th=t=>Uint8Array.from(t.split("").map(t=>t.charCodeAt(0))),tf=th("expand 16-byte k"),tc=th("expand 32-byte k"),tu=tn(tf),td=tn(tc);function tp(t,e){return t<<e|t>>>32-e}function tg(t){return t.byteOffset%4==0}let ty=0x100000000-1,tb=new Uint32Array,tw=(t,e)=>255&t[e++]|(255&t[e++])<<8;class tm{process(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{h:n,r:i}=this,o=i[0],s=i[1],a=i[2],l=i[3],h=i[4],f=i[5],c=i[6],u=i[7],d=i[8],p=i[9],g=tw(t,e+0),y=tw(t,e+2),b=tw(t,e+4),w=tw(t,e+6),m=tw(t,e+8),E=tw(t,e+10),x=tw(t,e+12),v=tw(t,e+14),O=n[0]+(8191&g),A=n[1]+((g>>>13|y<<3)&8191),I=n[2]+((y>>>10|b<<6)&8191),S=n[3]+((b>>>7|w<<9)&8191),B=n[4]+((w>>>4|m<<12)&8191),U=n[5]+(m>>>1&8191),C=n[6]+((m>>>14|E<<2)&8191),N=n[7]+((E>>>11|x<<5)&8191),_=n[8]+((x>>>8|v<<8)&8191),P=n[9]+(v>>>5|2048*!r),L=0,j=0+O*o+5*p*A+5*d*I+5*u*S+5*c*B;L=j>>>13,j&=8191,j+=5*f*U+5*h*C+5*l*N+5*a*_+5*s*P,L+=j>>>13,j&=8191;let k=L+O*s+A*o+5*p*I+5*d*S+5*u*B;L=k>>>13,k&=8191,k+=5*c*U+5*f*C+5*h*N+5*l*_+5*a*P,L+=k>>>13,k&=8191;let T=L+O*a+A*s+I*o+5*p*S+5*d*B;L=T>>>13,T&=8191,T+=5*u*U+5*c*C+5*f*N+5*h*_+5*l*P,L+=T>>>13,T&=8191;let R=L+O*l+A*a+I*s+S*o+5*p*B;L=R>>>13,R&=8191,R+=5*d*U+5*u*C+5*c*N+5*f*_+5*h*P,L+=R>>>13,R&=8191;let H=L+O*h+A*l+I*a+S*s+B*o;L=H>>>13,H&=8191,H+=5*p*U+5*d*C+5*u*N+5*c*_+5*f*P,L+=H>>>13,H&=8191;let z=L+O*f+A*h+I*l+S*a+B*s;L=z>>>13,z&=8191,z+=U*o+5*p*C+5*d*N+5*u*_+5*c*P,L+=z>>>13,z&=8191;let F=L+O*c+A*f+I*h+S*l+B*a;L=F>>>13,F&=8191,F+=U*s+C*o+5*p*N+5*d*_+5*u*P,L+=F>>>13,F&=8191;let D=L+O*u+A*c+I*f+S*h+B*l;L=D>>>13,D&=8191,D+=U*a+C*s+N*o+5*p*_+5*d*P,L+=D>>>13,D&=8191;let q=L+O*d+A*u+I*c+S*f+B*h;L=q>>>13,q&=8191,q+=U*l+C*a+N*s+_*o+5*p*P,L+=q>>>13,q&=8191;let M=L+O*p+A*d+I*u+S*c+B*f;L=M>>>13,M&=8191,M+=U*h+C*l+N*a+_*s+P*o,L+=M>>>13,M&=8191,j=8191&(L=(L=(L<<2)+L|0)+j|0),L>>>=13,k+=L,n[0]=j,n[1]=k,n[2]=T,n[3]=R,n[4]=H,n[5]=z,n[6]=F,n[7]=D,n[8]=q,n[9]=M}finalize(){let{h:t,pad:e}=this,r=new Uint16Array(10),n=t[1]>>>13;t[1]&=8191;for(let e=2;e<10;e++)t[e]+=n,n=t[e]>>>13,t[e]&=8191;t[0]+=5*n,n=t[0]>>>13,t[0]&=8191,t[1]+=n,n=t[1]>>>13,t[1]&=8191,t[2]+=n,r[0]=t[0]+5,n=r[0]>>>13,r[0]&=8191;for(let e=1;e<10;e++)r[e]=t[e]+n,n=r[e]>>>13,r[e]&=8191;r[9]-=8192;let i=(1^n)-1;for(let t=0;t<10;t++)r[t]&=i;i=~i;for(let e=0;e<10;e++)t[e]=t[e]&i|r[e];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let o=t[0]+e[0];t[0]=65535&o;for(let r=1;r<8;r++)o=(t[r]+e[r]|0)+(o>>>16)|0,t[r]=65535&o;tl(r)}update(t){te(this);let{buffer:e,blockLen:r}=this,n=(t=ti(t)).length;for(let i=0;i<n;){let o=Math.min(r-this.pos,n-i);if(o===r){for(;r<=n-i;i+=r)this.process(t,i);continue}e.set(t.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(e,0,!1),this.pos=0)}return this}destroy(){tl(this.h,this.r,this.buffer,this.pad)}digestInto(t){te(this),function(t,e){tt(t);let r=e.outputLen;if(t.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(t,this),this.finished=!0;let{buffer:e,h:r}=this,{pos:n}=this;if(n){for(e[n++]=1;n<16;n++)e[n]=0;this.process(e,0,!0)}this.finalize();let i=0;for(let e=0;e<8;e++)t[i++]=r[e]>>>0,t[i++]=r[e]>>>8;return t}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,tt(t=ti(t),32);let e=tw(t,0),r=tw(t,2),n=tw(t,4),i=tw(t,6),o=tw(t,8),s=tw(t,10),a=tw(t,12),l=tw(t,14);this.r[0]=8191&e,this.r[1]=(e>>>13|r<<3)&8191,this.r[2]=(r>>>10|n<<6)&7939,this.r[3]=(n>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|s<<2)&8191,this.r[7]=(s>>>11|a<<5)&8065,this.r[8]=(a>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let e=0;e<8;e++)this.pad[e]=tw(t,16+2*e)}}let tE=function(t){let e=(e,r)=>t(r).update(ti(e)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e}(t=>new tm(t)),tx=function(t,e){let{allowShortKeys:r,extendNonceFn:n,counterLength:i,counterRight:o,rounds:s}=function(t,e){if(null==e||"object"!=typeof e)throw Error("options must be defined");return Object.assign(t,e)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if("function"!=typeof t)throw Error("core must be a function");return Q(i),Q(s),tr(o),tr(r),function(e,a,l,h){let f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;tt(e),tt(a),tt(l);let c=l.length;if(void 0===h&&(h=new Uint8Array(c)),tt(h),Q(f),f<0||f>=ty)throw Error("arx: counter overflow");if(h.length<c)throw Error("arx: output (".concat(h.length,") is shorter than data (").concat(c,")"));let u=[],d=e.length,p,g;if(32===d)u.push(p=ta(e)),g=td;else if(16===d&&r)(p=new Uint8Array(32)).set(e),p.set(e,16),g=tu,u.push(p);else throw Error("arx: invalid 32-byte key, got length=".concat(d));tg(a)||u.push(a=ta(a));let y=tn(p);if(n){if(24!==a.length)throw Error("arx: extended nonce must be 24 bytes");n(g,y,tn(a.subarray(0,16)),y),a=a.subarray(16)}let b=16-i;if(b!==a.length)throw Error("arx: nonce must be ".concat(b," or 16 bytes"));if(12!==b){let t=new Uint8Array(12);t.set(a,o?0:12-a.length),a=t,u.push(a)}return function(t,e,r,n,i,o,s,a){let l=i.length,h=new Uint8Array(64),f=tn(h),c=tg(i)&&tg(o),u=c?tn(i):tb,d=c?tn(o):tb;for(let p=0;p<l;s++){if(t(e,r,n,f,s,a),s>=ty)throw Error("arx: counter overflow");let g=Math.min(64,l-p);if(c&&64===g){let t=p/4;if(p%4!=0)throw Error("arx: invalid block position");for(let e=0,r;e<16;e++)d[r=t+e]=u[r]^f[e];p+=64;continue}for(let t=0,e;t<g;t++)o[e=p+t]=i[e]^h[t];p+=g}}(t,g,y,tn(a),l,h,f,s),tl(...u),h}}(function(t,e,r,n,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,s=t[0],a=t[1],l=t[2],h=t[3],f=e[0],c=e[1],u=e[2],d=e[3],p=e[4],g=e[5],y=e[6],b=e[7],w=r[0],m=r[1],E=r[2],x=s,v=a,O=l,A=h,I=f,S=c,B=u,U=d,C=p,N=g,_=y,P=b,L=i,j=w,k=m,T=E;for(let t=0;t<o;t+=2)C=C+(L=tp(L^(x=x+I|0),16))|0,x=x+(I=tp(I^C,12))|0,C=C+(L=tp(L^x,8))|0,I=tp(I^C,7),N=N+(j=tp(j^(v=v+S|0),16))|0,v=v+(S=tp(S^N,12))|0,N=N+(j=tp(j^v,8))|0,S=tp(S^N,7),_=_+(k=tp(k^(O=O+B|0),16))|0,O=O+(B=tp(B^_,12))|0,_=_+(k=tp(k^O,8))|0,B=tp(B^_,7),P=P+(T=tp(T^(A=A+U|0),16))|0,A=A+(U=tp(U^P,12))|0,P=P+(T=tp(T^A,8))|0,U=tp(U^P,7),_=_+(T=tp(T^(x=x+S|0),16))|0,x=x+(S=tp(S^_,12))|0,_=_+(T=tp(T^x,8))|0,S=tp(S^_,7),P=P+(L=tp(L^(v=v+B|0),16))|0,v=v+(B=tp(B^P,12))|0,P=P+(L=tp(L^v,8))|0,B=tp(B^P,7),C=C+(j=tp(j^(O=O+U|0),16))|0,O=O+(U=tp(U^C,12))|0,C=C+(j=tp(j^O,8))|0,U=tp(U^C,7),N=N+(k=tp(k^(A=A+I|0),16))|0,A=A+(I=tp(I^N,12))|0,N=N+(k=tp(k^A,8))|0,I=tp(I^N,7);let R=0;n[R++]=s+x|0,n[R++]=a+v|0,n[R++]=l+O|0,n[R++]=h+A|0,n[R++]=f+I|0,n[R++]=c+S|0,n[R++]=u+B|0,n[R++]=d+U|0,n[R++]=p+C|0,n[R++]=g+N|0,n[R++]=y+_|0,n[R++]=b+P|0,n[R++]=i+L|0,n[R++]=w+j|0,n[R++]=m+k|0,n[R++]=E+T|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),tv=new Uint8Array(16),tO=(t,e)=>{t.update(e);let r=e.length%16;r&&t.update(tv.subarray(r))},tA=new Uint8Array(32);function tI(t,e,r,n,i){let o=t(e,r,tA),s=tE.create(o);i&&tO(s,i),tO(s,n);let a=new Uint8Array(16),l=new DataView(a.buffer,a.byteOffset,a.byteLength);ts(l,0,BigInt(i?i.length:0),!0),ts(l,8,BigInt(n.length),!0),s.update(a);let h=s.digest();return tl(o,a),h}((t,e)=>Object.assign(function(r){for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];if(tt(r),void 0!==t.nonceLength){let e=i[0];if(!e)throw Error("nonce / iv required");t.varSizeNonce?tt(e):tt(e,t.nonceLength)}let s=t.tagLength;s&&void 0!==i[1]&&tt(i[1]);let a=e(r,...i),l=(t,e)=>{if(void 0!==e){if(2!==t)throw Error("cipher output not supported");tt(e)}},h=!1;return{encrypt(t,e){if(h)throw Error("cannot encrypt() twice with same key + nonce");return h=!0,tt(t),l(a.encrypt.length,e),a.encrypt(t,e)},decrypt(t,e){if(tt(t),s&&t.length<s)throw Error("invalid ciphertext length: smaller than tagLength="+s);return l(a.decrypt.length,e),a.decrypt(t,e)}}},t))({blockSize:64,nonceLength:12,tagLength:16},(t=>(e,r,n)=>({encrypt(i,o){let s=i.length;(o=to(s+16,o,!1)).set(i);let a=o.subarray(0,-16);t(e,r,a,a,1);let l=tI(t,e,r,a,n);return o.set(l,s),tl(l),o},decrypt(i,o){o=to(i.length-16,o,!1);let s=i.subarray(0,-16),a=i.subarray(-16),l=tI(t,e,r,s,n);if(!function(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return 0===r}(a,l))throw Error("invalid tag");return o.set(i.subarray(0,-16)),t(e,r,o,o,1),tl(l),o}}))(tx));class tS extends k{update(t){return I(this),this.iHash.update(t),this}digestInto(t){I(this),A(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return t.finished=n,t.destroyed=i,t.blockLen=o,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}constructor(t,e){super(),this.finished=!1,this.destroyed=!1,function(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.wrapConstructor");O(t.outputLen),O(t.blockLen)}(t);let r=j(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?t.create().update(r).digest():r);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),i.fill(0)}}let tB=(t,e,r)=>new tS(t,e).update(r).digest();tB.create=(t,e)=>new tS(t,e),new Uint8Array([0]),new Uint8Array;class tU extends k{update(t){I(this);let{view:e,buffer:r,blockLen:n}=this,i=(t=j(t)).length;for(let o=0;o<i;){let s=Math.min(n-this.pos,i-o);if(s===n){let e=N(t);for(;n<=i-o;o+=n)this.process(e,o);continue}r.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){I(this),S(t,this),this.finished=!0;let{buffer:e,view:r,blockLen:n,isLE:i}=this,{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(let t=o;t<n;t++)e[t]=0;(function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>i&o),a=Number(r&o),l=4*!!n,h=4*!n;t.setUint32(e+l,s,n),t.setUint32(e+h,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);let s=N(t),a=this.outputLen;if(a%4)throw Error("_sha2: outputLen should be aligned to 32bit");let l=a/4,h=this.get();if(l>h.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<l;t++)s.setUint32(4*t,h[t],i)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return t.length=n,t.pos=s,t.finished=i,t.destroyed=o,n%e&&t.buffer.set(r),t}constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=N(this.buffer)}}let tC=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),tN=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),t_=new Uint32Array(64);class tP extends tU{get(){let{A:t,B:e,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[t,e,r,n,i,o,s,a]}set(t,e,r,n,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)t_[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=t_[t-15],r=t_[t-2],n=_(e,7)^_(e,18)^e>>>3,i=_(r,17)^_(r,19)^r>>>10;t_[t]=i+t_[t-7]+n+t_[t-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:l,H:h}=this;for(let t=0;t<64;t++){var f,c,u,d;let e=h+(_(s,6)^_(s,11)^_(s,25))+((f=s)&a^~f&l)+tC[t]+t_[t]|0,p=(_(r,2)^_(r,13)^_(r,22))+((c=r)&(u=n)^c&(d=i)^u&d)|0;h=l,l=a,a=s,s=o+e|0,o=i,i=n,n=r,r=e+p|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,l=l+this.G|0,h=h+this.H|0,this.set(r,n,i,o,s,a,l,h)}roundClean(){t_.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}constructor(){super(64,32,8,!1),this.A=0|tN[0],this.B=0|tN[1],this.C=0|tN[2],this.D=0|tN[3],this.E=0|tN[4],this.F=0|tN[5],this.G=0|tN[6],this.H=0|tN[7]}}let tL=T(()=>new tP),tj=BigInt(0),tk=BigInt(1),tT=BigInt(2);function tR(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function tH(t){if(!tR(t))throw Error("Uint8Array expected")}function tz(t,e){if("boolean"!=typeof e)throw Error(t+" boolean expected, got "+e)}let tF=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function tD(t){tH(t);let e="";for(let r=0;r<t.length;r++)e+=tF[t[r]];return e}function tq(t){let e=t.toString(16);return 1&e.length?"0"+e:e}function tM(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return""===t?tj:BigInt("0x"+t)}let tV={_0:48,_9:57,A:65,F:70,a:97,f:102};function tW(t){return t>=tV._0&&t<=tV._9?t-tV._0:t>=tV.A&&t<=tV.F?t-(tV.A-10):t>=tV.a&&t<=tV.f?t-(tV.a-10):void 0}function tX(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){let r=tW(t.charCodeAt(i)),o=tW(t.charCodeAt(i+1));if(void 0===r||void 0===o)throw Error('hex string expected, got non-hex character "'+(t[i]+t[i+1])+'" at index '+i);n[e]=16*r+o}return n}function tY(t){return tM(tD(t))}function tZ(t){return tH(t),tM(tD(Uint8Array.from(t).reverse()))}function tK(t,e){return tX(t.toString(16).padStart(2*e,"0"))}function tG(t,e){return tK(t,e).reverse()}function tJ(t,e,r){let n;if("string"==typeof e)try{n=tX(e)}catch(e){throw Error(t+" must be hex string or Uint8Array, cause: "+e)}else if(tR(e))n=Uint8Array.from(e);else throw Error(t+" must be hex string or Uint8Array");let i=n.length;if("number"==typeof r&&i!==r)throw Error(t+" of length "+r+" expected, got "+i);return n}function tQ(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let n=0;for(let t=0;t<e.length;t++){let r=e[t];tH(r),n+=r.length}let i=new Uint8Array(n);for(let t=0,r=0;t<e.length;t++){let n=e[t];i.set(n,r),r+=n.length}return i}let t$=t=>"bigint"==typeof t&&tj<=t;function t0(t,e,r){return t$(t)&&t$(e)&&t$(r)&&e<=t&&t<r}function t1(t,e,r,n){if(!t0(e,r,n))throw Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function t2(t){let e;for(e=0;t>tj;t>>=tk,e+=1);return e}let t8=t=>(tT<<BigInt(t-1))-tk,t3=t=>new Uint8Array(t),t5=t=>Uint8Array.from(t);function t6(t,e,r){if("number"!=typeof t||t<2)throw Error("hashLen must be a number");if("number"!=typeof e||e<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let n=t3(t),i=t3(t),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=function(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];return r(i,n,...e)},l=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t3();i=a(t5([0]),t),n=a(),0!==t.length&&(i=a(t5([1]),t),n=a())},h=()=>{if(o++>=1e3)throw Error("drbg: tried 1000 values");let t=0,r=[];for(;t<e;){let e=(n=a()).slice();r.push(e),t+=n.length}return tQ(...r)};return(t,e)=>{let r;for(s(),l(t);!(r=e(h()));)l();return s(),r}}let t4={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||tR(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function t9(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=(e,r,n)=>{let i=t4[r];if("function"!=typeof i)throw Error("invalid validator function");let o=t[e];if(!(n&&void 0===o)&&!i(o,t))throw Error("param "+String(e)+" is invalid. Expected "+r+", got "+o)};for(let[t,r]of Object.entries(e))n(t,r,!1);for(let[t,e]of Object.entries(r))n(t,e,!0);return t}function t7(t){let e=new WeakMap;return function(r){for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];let s=e.get(r);if(void 0!==s)return s;let a=t(r,...i);return e.set(r,a),a}}var et=Object.freeze({__proto__:null,isBytes:tR,abytes:tH,abool:tz,bytesToHex:tD,numberToHexUnpadded:tq,hexToNumber:tM,hexToBytes:tX,bytesToNumberBE:tY,bytesToNumberLE:tZ,numberToBytesBE:tK,numberToBytesLE:tG,numberToVarBytesBE:function(t){return tX(tq(t))},ensureBytes:tJ,concatBytes:tQ,equalBytes:function(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return 0===r},utf8ToBytes:function(t){if("string"!=typeof t)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(t))},inRange:t0,aInRange:t1,bitLen:t2,bitGet:function(t,e){return t>>BigInt(e)&tk},bitSet:function(t,e,r){return t|(r?tk:tj)<<BigInt(e)},bitMask:t8,createHmacDrbg:t6,validateObject:t9,notImplemented:()=>{throw Error("not implemented")},memoized:t7});let ee=BigInt(0),er=BigInt(1),en=BigInt(2),ei=BigInt(3),eo=BigInt(4),es=BigInt(5),ea=BigInt(8);function el(t,e){let r=t%e;return r>=ee?r:e+r}function eh(t,e,r){if(e<ee)throw Error("invalid exponent, negatives unsupported");if(r<=ee)throw Error("invalid modulus");if(r===er)return ee;let n=er;for(;e>ee;)e&er&&(n=n*t%r),t=t*t%r,e>>=er;return n}function ef(t,e,r){let n=t;for(;e-- >ee;)n*=n,n%=r;return n}function ec(t,e){if(t===ee)throw Error("invert: expected non-zero number");if(e<=ee)throw Error("invert: expected positive modulus, got "+e);let r=el(t,e),n=e,i=ee,o=er;for(;r!==ee;){let t=n/r,e=n%r,s=i-o*t;n=r,r=e,i=o,o=s}if(n!==er)throw Error("invert: does not exist");return el(i,e)}let eu=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ed(t,e){let r=void 0!==e?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function ep(t,e){let r,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t<=ee)throw Error("invalid field: expected ORDER > 0, got "+t);let{nBitLength:o,nByteLength:s}=ed(t,e);if(s>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let a=Object.freeze({ORDER:t,isLE:n,BITS:o,BYTES:s,MASK:t8(o),ZERO:ee,ONE:er,create:e=>el(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error("invalid field element: expected bigint, got "+typeof e);return ee<=e&&e<t},is0:t=>t===ee,isOdd:t=>(t&er)===er,neg:e=>el(-e,t),eql:(t,e)=>t===e,sqr:e=>el(e*e,t),add:(e,r)=>el(e+r,t),sub:(e,r)=>el(e-r,t),mul:(e,r)=>el(e*r,t),pow:(t,e)=>(function(t,e,r){if(r<ee)throw Error("invalid exponent, negatives unsupported");if(r===ee)return t.ONE;if(r===er)return e;let n=t.ONE,i=e;for(;r>ee;)r&er&&(n=t.mul(n,i)),i=t.sqr(i),r>>=er;return n})(a,t,e),div:(e,r)=>el(e*ec(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>ec(e,t),sqrt:i.sqrt||(e=>(r||(r=function(t){if(t%eo===ei){let e=(t+er)/eo;return function(t,r){let n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw Error("Cannot find square root");return n}}if(t%ea===es){let e=(t-es)/ea;return function(t,r){let n=t.mul(r,en),i=t.pow(n,e),o=t.mul(r,i),s=t.mul(t.mul(o,en),i),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),r))throw Error("Cannot find square root");return a}}return function(t){let e,r,n,i=(t-er)/en;for(e=t-er,r=0;e%en===ee;e/=en,r++);for(n=en;n<t&&eh(n,i,t)!==t-er;n++)if(n>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===r){let e=(t+er)/eo;return function(t,r){let n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw Error("Cannot find square root");return n}}let o=(e+er)/en;return function(t,s){if(t.pow(s,i)===t.neg(t.ONE))throw Error("Cannot find square root");let a=r,l=t.pow(t.mul(t.ONE,n),e),h=t.pow(s,o),f=t.pow(s,e);for(;!t.eql(f,t.ONE);){if(t.eql(f,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(f);e<a&&!t.eql(r,t.ONE);e++)r=t.sqr(r);let r=t.pow(l,er<<BigInt(a-e-1));l=t.sqr(r),h=t.mul(h,r),f=t.mul(f,l),a=e}return h}}(t)}(t)),r(a,e))),invertBatch:t=>(function(t,e){let r=Array(e.length),n=e.reduce((e,n,i)=>t.is0(n)?e:(r[i]=e,t.mul(e,n)),t.ONE),i=t.inv(n);return e.reduceRight((e,n,i)=>t.is0(n)?e:(r[i]=t.mul(e,r[i]),t.mul(e,n)),i),r})(a,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>n?tG(t,s):tK(t,s),fromBytes:t=>{if(t.length!==s)throw Error("Field.fromBytes: expected "+s+" bytes, got "+t.length);return n?tZ(t):tY(t)}});return Object.freeze(a)}function eg(t){if("bigint"!=typeof t)throw Error("field order must be bigint");return Math.ceil(t.toString(2).length/8)}function ey(t){let e=eg(t);return e+Math.ceil(e/2)}let eb=BigInt(0),ew=BigInt(1);function em(t,e){let r=e.negate();return t?r:e}function eE(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw Error("invalid window size, expected [1.."+e+"], got W="+t)}function ex(t,e){return eE(t,e),{windows:Math.ceil(e/t)+1,windowSize:2**(t-1)}}let ev=new WeakMap,eO=new WeakMap;function eA(t){return eO.get(t)||1}function eI(t){return t9(t.Fp,eu.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),t9(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ed(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);let eS=BigInt(0),eB=BigInt(1),eU=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);let eC=BigInt(1),eN=BigInt(2),e_=BigInt(3),eP=BigInt(5);function eL(t){void 0!==t.lowS&&tz("lowS",t.lowS),void 0!==t.prehash&&tz("prehash",t.prehash)}BigInt(8),!function(t){let e=(t9(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})),{P:r}=e,n=t=>el(t,r),i=e.montgomeryBits,o=Math.ceil(i/8),s=e.nByteLength,a=e.adjustScalarBytes||(t=>t),l=e.powPminus2||(t=>eh(t,r-BigInt(2),r));(e.a-BigInt(2))/BigInt(4);tG(n(e.Gu),o)}({P:eU,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{let{pow_p_5_8:e,b2:r}=function(t){let e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=t*t%eU*t%eU,s=ef(o,eN,eU)*o%eU,a=ef(s,eC,eU)*t%eU,l=ef(a,eP,eU)*a%eU,h=ef(l,e,eU)*l%eU,f=ef(h,r,eU)*h%eU,c=ef(f,n,eU)*f%eU,u=ef(c,i,eU)*c%eU,d=ef(u,i,eU)*c%eU,p=ef(d,e,eU)*l%eU;return{pow_p_5_8:ef(p,eN,eU)*t%eU,b2:o}}(t);return el(ef(e,e_,eU)*r,eU)},adjustScalarBytes:function(t){return t[0]&=248,t[31]&=127,t[31]|=64,t},randomBytes:R});let{bytesToNumberBE:ej,hexToBytes:ek}=et,eT={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(t,e)=>{let{Err:r}=eT;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(1&e.length)throw new r("tlv.encode: unpadded data");let n=e.length/2,i=tq(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");let o=n>127?tq(i.length/2|128):"";return tq(t)+o+i+e},decode(t,e){let{Err:r}=eT,n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");let i=e[n++],o=0;if(128&i){let t=127&i;if(!t)throw new r("tlv.decode(long): indefinite length not supported");if(t>4)throw new r("tlv.decode(long): byte length is too big");let s=e.subarray(n,n+t);if(s.length!==t)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");for(let t of s)o=o<<8|t;if(n+=t,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=i;let s=e.subarray(n,n+o);if(s.length!==o)throw new r("tlv.decode: wrong value length");return{v:s,l:e.subarray(n+o)}}},_int:{encode(t){let{Err:e}=eT;if(t<eR)throw new e("integer: negative integers are not allowed");let r=tq(t);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){let{Err:e}=eT;if(128&t[0])throw new e("invalid signature integer: negative");if(0===t[0]&&!(128&t[1]))throw new e("invalid signature integer: unnecessary leading zero");return ej(t)}},toSig(t){let{Err:e,_int:r,_tlv:n}=eT,i="string"==typeof t?ek(t):t;tH(i);let{v:o,l:s}=n.decode(48,i);if(s.length)throw new e("invalid signature: left bytes after parsing");let{v:a,l:l}=n.decode(2,o),{v:h,l:f}=n.decode(2,l);if(f.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(h)}},hexFromSig(t){let{_tlv:e,_int:r}=eT,n=e.encode(2,r.encode(t.r)),i=e.encode(2,r.encode(t.s));return e.encode(48,n+i)}},eR=BigInt(0),eH=BigInt(1);BigInt(2);let ez=BigInt(3);BigInt(4);let eF=ep(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"));(function(t,e){let r=e=>(function(t){let e=function(t){let e=eI(t);return t9(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:r,n:n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(t){return el(t,n)}let{ProjectivePoint:a,normPrivateKeyToScalar:l,weierstrassEquation:h,isWithinCurveOrder:f}=function(t){var e;let r=function(t){let e=eI(t);t9(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:n}=r,i=ep(r.n,r.nBitLength),o=r.toBytes||((t,e,r)=>{let i=e.toAffine();return tQ(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))}),s=r.fromBytes||(t=>{let e=t.subarray(1);return{x:n.fromBytes(e.subarray(0,n.BYTES)),y:n.fromBytes(e.subarray(n.BYTES,2*n.BYTES))}});function a(t){let{a:e,b:i}=r,o=n.sqr(t),s=n.mul(o,t);return n.add(n.add(s,n.mul(t,e)),i)}if(!n.eql(n.sqr(r.Gy),a(r.Gx)))throw Error("bad generator point: equation left != right");function l(t){let e,{allowedPrivateKeyLengths:n,nByteLength:i,wrapPrivateKey:o,n:s}=r;if(n&&"bigint"!=typeof t){if(tR(t)&&(t=tD(t)),"string"!=typeof t||!n.includes(t.length))throw Error("invalid private key");t=t.padStart(2*i,"0")}try{e="bigint"==typeof t?t:tY(tJ("private key",t,i))}catch(e){throw Error("invalid private key, expected hex or "+i+" bytes, got "+typeof t)}return o&&(e=el(e,s)),t1("private key",e,eH,s),e}function h(t){if(!(t instanceof u))throw Error("ProjectivePoint expected")}let f=t7((t,e)=>{let{px:r,py:i,pz:o}=t;if(n.eql(o,n.ONE))return{x:r,y:i};let s=t.is0();null==e&&(e=s?n.ONE:n.inv(o));let a=n.mul(r,e),l=n.mul(i,e),h=n.mul(o,e);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(h,n.ONE))throw Error("invZ was invalid");return{x:a,y:l}}),c=t7(t=>{if(t.is0()){if(r.allowInfinityPoint&&!n.is0(t.py))return;throw Error("bad point: ZERO")}let{x:e,y:i}=t.toAffine();if(!n.isValid(e)||!n.isValid(i))throw Error("bad point: x or y not FE");let o=n.sqr(i),s=a(e);if(!n.eql(o,s))throw Error("bad point: equation left != right");if(!t.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class u{static fromAffine(t){let{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw Error("invalid affine point");if(t instanceof u)throw Error("projective point not allowed");let i=t=>n.eql(t,n.ZERO);return i(e)&&i(r)?u.ZERO:new u(e,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){let e=n.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(u.fromAffine)}static fromHex(t){let e=u.fromAffine(s(tJ("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return u.BASE.multiply(l(t))}static msm(t,e){return function(t,e,r,n){if(function(t,e){if(!Array.isArray(t))throw Error("array expected");t.forEach((t,r)=>{if(!(t instanceof e))throw Error("invalid point at index "+r)})}(r,t),function(t,e){if(!Array.isArray(t))throw Error("array of scalars expected");t.forEach((t,r)=>{if(!e.isValid(t))throw Error("invalid scalar at index "+r)})}(n,e),r.length!==n.length)throw Error("arrays of points and scalars must have equal length");let i=t.ZERO,o=t2(BigInt(r.length)),s=o>12?o-3:o>4?o-2:o?2:1,a=(1<<s)-1,l=Array(a+1).fill(i),h=Math.floor((e.BITS-1)/s)*s,f=i;for(let t=h;t>=0;t-=s){l.fill(i);for(let e=0;e<n.length;e++){let i=Number(n[e]>>BigInt(t)&BigInt(a));l[i]=l[i].add(r[e])}let e=i;for(let t=l.length-1,r=i;t>0;t--)r=r.add(l[t]),e=e.add(r);if(f=f.add(e),0!==t)for(let t=0;t<s;t++)f=f.double()}return f}(u,i,t,e)}_setWindowSize(t){p.setWindowSize(this,t)}assertValidity(){c(this)}hasEvenY(){let{y:t}=this.toAffine();if(n.isOdd)return!n.isOdd(t);throw Error("Field doesn't support isOdd")}equals(t){h(t);let{px:e,py:r,pz:i}=this,{px:o,py:s,pz:a}=t,l=n.eql(n.mul(e,a),n.mul(o,i)),f=n.eql(n.mul(r,a),n.mul(s,i));return l&&f}negate(){return new u(this.px,n.neg(this.py),this.pz)}double(){let{a:t,b:e}=r,i=n.mul(e,ez),{px:o,py:s,pz:a}=this,l=n.ZERO,h=n.ZERO,f=n.ZERO,c=n.mul(o,o),d=n.mul(s,s),p=n.mul(a,a),g=n.mul(o,s);return g=n.add(g,g),f=n.mul(o,a),f=n.add(f,f),l=n.mul(t,f),h=n.mul(i,p),h=n.add(l,h),l=n.sub(d,h),h=n.add(d,h),h=n.mul(l,h),l=n.mul(g,l),f=n.mul(i,f),p=n.mul(t,p),g=n.sub(c,p),g=n.mul(t,g),g=n.add(g,f),f=n.add(c,c),c=n.add(f,c),c=n.add(c,p),c=n.mul(c,g),h=n.add(h,c),p=n.mul(s,a),p=n.add(p,p),c=n.mul(p,g),l=n.sub(l,c),f=n.mul(p,d),f=n.add(f,f),new u(l,h,f=n.add(f,f))}add(t){h(t);let{px:e,py:i,pz:o}=this,{px:s,py:a,pz:l}=t,f=n.ZERO,c=n.ZERO,d=n.ZERO,p=r.a,g=n.mul(r.b,ez),y=n.mul(e,s),b=n.mul(i,a),w=n.mul(o,l),m=n.add(e,i),E=n.add(s,a);m=n.mul(m,E),E=n.add(y,b),m=n.sub(m,E),E=n.add(e,o);let x=n.add(s,l);return E=n.mul(E,x),x=n.add(y,w),E=n.sub(E,x),x=n.add(i,o),f=n.add(a,l),x=n.mul(x,f),f=n.add(b,w),x=n.sub(x,f),d=n.mul(p,E),f=n.mul(g,w),d=n.add(f,d),f=n.sub(b,d),d=n.add(b,d),c=n.mul(f,d),b=n.add(y,y),b=n.add(b,y),w=n.mul(p,w),E=n.mul(g,E),b=n.add(b,w),w=n.sub(y,w),w=n.mul(p,w),E=n.add(E,w),y=n.mul(b,E),c=n.add(c,y),y=n.mul(x,E),f=n.mul(m,f),f=n.sub(f,y),y=n.mul(m,b),d=n.mul(x,d),new u(f,c,d=n.add(d,y))}subtract(t){return this.add(t.negate())}is0(){return this.equals(u.ZERO)}wNAF(t){return p.wNAFCached(this,t,u.normalizeZ)}multiplyUnsafe(t){let{endo:e,n:i}=r;t1("scalar",t,eR,i);let o=u.ZERO;if(t===eR)return o;if(this.is0()||t===eH)return this;if(!e||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,t,u.normalizeZ);let{k1neg:s,k1:a,k2neg:l,k2:h}=e.splitScalar(t),f=o,c=o,d=this;for(;a>eR||h>eR;)a&eH&&(f=f.add(d)),h&eH&&(c=c.add(d)),d=d.double(),a>>=eH,h>>=eH;return s&&(f=f.negate()),l&&(c=c.negate()),c=new u(n.mul(c.px,e.beta),c.py,c.pz),f.add(c)}multiply(t){let e,i,{endo:o,n:s}=r;if(t1("scalar",t,eH,s),o){let{k1neg:r,k1:s,k2neg:a,k2:l}=o.splitScalar(t),{p:h,f:f}=this.wNAF(s),{p:c,f:d}=this.wNAF(l);h=p.constTimeNegate(r,h),c=p.constTimeNegate(a,c),c=new u(n.mul(c.px,o.beta),c.py,c.pz),e=h.add(c),i=f.add(d)}else{let{p:r,f:n}=this.wNAF(t);e=r,i=n}return u.normalizeZ([e,i])[0]}multiplyAndAddUnsafe(t,e,r){let n=u.BASE,i=(t,e)=>e!==eR&&e!==eH&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),o=i(this,e).add(i(t,r));return o.is0()?void 0:o}toAffine(t){return f(this,t)}isTorsionFree(){let{h:t,isTorsionFree:e}=r;if(t===eH)return!0;if(e)return e(u,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:t,clearCofactor:e}=r;return t===eH?this:e?e(u,this):this.multiplyUnsafe(r.h)}toRawBytes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return tz("isCompressed",t),this.assertValidity(),o(u,this,t)}toHex(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return tz("isCompressed",t),tD(this.toRawBytes(t))}constructor(t,e,r){if(this.px=t,this.py=e,this.pz=r,null==t||!n.isValid(t))throw Error("x required");if(null==e||!n.isValid(e))throw Error("y required");if(null==r||!n.isValid(r))throw Error("z required");Object.freeze(this)}}u.BASE=new u(r.Gx,r.Gy,n.ONE),u.ZERO=new u(n.ZERO,n.ONE,n.ZERO);let d=r.nBitLength,p=(e=r.endo?Math.ceil(d/2):d,{constTimeNegate:em,hasPrecomputes:t=>1!==eA(t),unsafeLadder(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.ZERO,n=t;for(;e>eb;)e&ew&&(r=r.add(n)),n=n.double(),e>>=ew;return r},precomputeWindow(t,r){let{windows:n,windowSize:i}=ex(r,e),o=[],s=t,a=s;for(let t=0;t<n;t++){a=s,o.push(a);for(let t=1;t<i;t++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(t,r,n){let{windows:i,windowSize:o}=ex(t,e),s=u.ZERO,a=u.BASE,l=BigInt(2**t-1),h=2**t,f=BigInt(t);for(let t=0;t<i;t++){let e=t*o,i=Number(n&l);n>>=f,i>o&&(i-=h,n+=ew);let c=e+Math.abs(i)-1,u=t%2!=0,d=i<0;0===i?a=a.add(em(u,r[e])):s=s.add(em(d,r[c]))}return{p:s,f:a}},wNAFUnsafe(t,r,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u.ZERO,{windows:o,windowSize:s}=ex(t,e),a=BigInt(2**t-1),l=2**t,h=BigInt(t);for(let t=0;t<o;t++){let e=t*s;if(n===eb)break;let o=Number(n&a);if(n>>=h,o>s&&(o-=l,n+=ew),0===o)continue;let f=r[e+Math.abs(o)-1];o<0&&(f=f.negate()),i=i.add(f)}return i},getPrecomputes(t,e,r){let n=ev.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&ev.set(e,r(n))),n},wNAFCached(t,e,r){let n=eA(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)},wNAFCachedUnsafe(t,e,r,n){let i=eA(t);return 1===i?this.unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)},setWindowSize(t,r){eE(r,e),eO.set(t,r),ev.delete(t)}});return{CURVE:r,ProjectivePoint:u,normPrivateKeyToScalar:l,weierstrassEquation:a,isWithinCurveOrder:function(t){return t0(t,eH,r.n)}}}({...e,toBytes(t,e,n){let i=e.toAffine(),o=r.toBytes(i.x);return tz("isCompressed",n),n?tQ(Uint8Array.from([e.hasEvenY()?2:3]),o):tQ(Uint8Array.from([4]),o,r.toBytes(i.y))},fromBytes(t){let e=t.length,n=t[0],s=t.subarray(1);if(e===i&&(2===n||3===n)){let t,e=tY(s);if(!t0(e,eH,r.ORDER))throw Error("Point is not on curve");let i=h(e);try{t=r.sqrt(i)}catch(t){throw Error("Point is not on curve"+(t instanceof Error?": "+t.message:""))}return(1&n)==1!=((t&eH)===eH)&&(t=r.neg(t)),{x:e,y:t}}if(e===o&&4===n)return{x:r.fromBytes(s.subarray(0,r.BYTES)),y:r.fromBytes(s.subarray(r.BYTES,2*r.BYTES))};throw Error("invalid Point, expected length of "+i+", or uncompressed "+o+", got "+e)}}),c=t=>tD(tK(t,e.nByteLength)),u=(t,e,r)=>tY(t.slice(e,r));class d{static fromCompact(t){let r=e.nByteLength;return new d(u(t=tJ("compactSignature",t,2*r),0,r),u(t,r,2*r))}static fromDER(t){let{r:e,s:r}=eT.toSig(tJ("DER",t));return new d(e,r)}assertValidity(){t1("r",this.r,eH,n),t1("s",this.s,eH,n)}addRecoveryBit(t){return new d(this.r,this.s,t)}recoverPublicKey(t){let{r:i,s:o,recovery:l}=this,h=y(tJ("msgHash",t));if(null==l||![0,1,2,3].includes(l))throw Error("recovery id invalid");let f=2===l||3===l?i+e.n:i;if(f>=r.ORDER)throw Error("recovery id 2 or 3 invalid");let u=(1&l)==0?"02":"03",d=a.fromHex(u+c(f)),p=ec(f,n),g=s(-h*p),b=s(o*p),w=a.BASE.multiplyAndAddUnsafe(d,g,b);if(!w)throw Error("point at infinify");return w.assertValidity(),w}hasHighS(){return this.s>n>>eH}normalizeS(){return this.hasHighS()?new d(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return tX(this.toDERHex())}toDERHex(){return eT.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return tX(this.toCompactHex())}toCompactHex(){return c(this.r)+c(this.s)}constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}}function p(t){let e=tR(t),r="string"==typeof t,n=(e||r)&&t.length;return e?n===i||n===o:r?n===2*i||n===2*o:t instanceof a}let g=e.bits2int||function(t){if(t.length>8192)throw Error("input is too large");let r=tY(t),n=8*t.length-e.nBitLength;return n>0?r>>BigInt(n):r},y=e.bits2int_modN||function(t){return s(g(t))},b=t8(e.nBitLength);function w(t){return t1("num < 2^"+e.nBitLength,t,eR,b),tK(t,e.nByteLength)}let m={lowS:e.lowS,prehash:!1},E={lowS:e.lowS,prehash:!1};return a.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return a.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(p(t))throw Error("first arg must be private key");if(!p(e))throw Error("second arg must be public key");return a.fromHex(e).multiply(l(t)).toRawBytes(r)},sign:function(t,i){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m,{seed:h,k2sig:c}=function(t,i){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m;if(["recovered","canonical"].some(t=>t in o))throw Error("sign() legacy options not supported");let{hash:h,randomBytes:c}=e,{lowS:u,prehash:p,extraEntropy:b}=o;null==u&&(u=!0),t=tJ("msgHash",t),eL(o),p&&(t=tJ("prehashed msgHash",h(t)));let E=y(t),x=l(i),v=[w(x),w(E)];if(null!=b&&!1!==b){let t=!0===b?c(r.BYTES):b;v.push(tJ("extraEntropy",t))}return{seed:tQ(...v),k2sig:function(t){let e=g(t);if(!f(e))return;let r=ec(e,n),i=a.BASE.multiply(e).toAffine(),o=s(i.x);if(o===eR)return;let l=s(r*s(E+o*x));if(l===eR)return;let h=2*(i.x!==o)|Number(i.y&eH),c=l;return u&&l>n>>eH&&(c=l>n>>eH?s(-l):l,h^=1),new d(o,c,h)}}}(t,i,o);return t6(e.hash.outputLen,e.nByteLength,e.hmac)(h,c)},verify:function(t,r,i){var o;let l,h,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:E;r=tJ("msgHash",r),i=tJ("publicKey",i);let{lowS:c,prehash:u,format:p}=f;if(eL(f),"strict"in f)throw Error("options.strict was renamed to lowS");if(void 0!==p&&"compact"!==p&&"der"!==p)throw Error("format must be compact or der");let g="string"==typeof t||tR(t),b=!g&&!p&&"object"==typeof t&&null!==t&&"bigint"==typeof t.r&&"bigint"==typeof t.s;if(!g&&!b)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(b&&(l=new d(t.r,t.s)),g){try{"compact"!==p&&(l=d.fromDER(t))}catch(t){if(!(t instanceof eT.Err))throw t}l||"der"===p||(l=d.fromCompact(t))}h=a.fromHex(i)}catch(t){return!1}if(!l||c&&l.hasHighS())return!1;u&&(r=e.hash(r));let{r:w,s:m}=l,x=y(r),v=ec(m,n),O=s(x*v),A=s(w*v),I=null==(o=a.BASE.multiplyAndAddUnsafe(h,O,A))?void 0:o.toAffine();return!!I&&s(I.x)===w},ProjectivePoint:a,Signature:d,utils:{isValidPrivateKey(t){try{return l(t),!0}catch(t){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{let t=ey(e.n);return function(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t.length,i=eg(e),o=ey(e);if(n<16||n<o||n>1024)throw Error("expected "+o+"-1024 bytes of input, got "+n);let s=el(r?tZ(t):tY(t),e-er)+er;return r?tG(s,i):tK(s,i)}(e.randomBytes(t),e.n)},precompute(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.BASE;return e._setWindowSize(t),e.multiply(BigInt(3)),e}}}})({...t,hash:e,hmac:function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return tB(e,t,function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let n=0;for(let t=0;t<e.length;t++){let r=e[t];A(r),n+=r.length}let i=new Uint8Array(n);for(let t=0,r=0;t<e.length;t++){let n=e[t];i.set(n,r),r+=n.length}return i}(...n))},randomBytes:R});({...r(e),create:r})})({a:eF.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:eF,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},tL),Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,t.i(319863),t.i(191105),t.i(948031),t.i(583486),t.i(697400),"".concat("wc","@2:").concat("core",":"),i.ONE_DAY,i.SIX_HOURS,i.THIRTY_DAYS,i.FIVE_SECONDS,i.THIRTY_DAYS,i.ONE_DAY,i.ONE_DAY,i.THIRTY_SECONDS,i.THIRTY_SECONDS,i.ONE_DAY,i.ONE_DAY,i.ONE_DAY;var eD=function(t,e){if(t.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw TypeError(o+" is ambiguous");r[s]=i}var a=t.length,l=t.charAt(0),h=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function c(t){if("string"!=typeof t)throw TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[0]){for(var n=0,i=0;t[e]===l;)n++,e++;for(var o=(t.length-e)*h+1>>>0,s=new Uint8Array(o);t[e];){var f=r[t.charCodeAt(e)];if(255===f)return;for(var c=0,u=o-1;(0!==f||c<i)&&-1!==u;u--,c++)f+=a*s[u]>>>0,s[u]=f%256>>>0,f=f/256>>>0;if(0!==f)throw Error("Non-zero carry");i=c,e++}if(" "!==t[e]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var p=new Uint8Array(n+(o-d)),g=n;d!==o;)p[g++]=s[d++];return p}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var s=(o-i)*f+1>>>0,h=new Uint8Array(s);i!==o;){for(var c=e[i],u=0,d=s-1;(0!==c||u<n)&&-1!==d;d--,u++)c+=256*h[d]>>>0,h[d]=c%a>>>0,c=c/a>>>0;if(0!==c)throw Error("Non-zero carry");n=u,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var g=l.repeat(r);p<s;++p)g+=t.charAt(h[p]);return g},decodeUnsafe:c,decode:function(t){var r=c(t);if(r)return r;throw Error("Non-".concat(e," character"))}}};let eq=t=>{if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw Error("Unknown type, must be binary type")};class eM{encode(t){if(t instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(t));throw Error("Unknown type, must be binary type")}constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}}class eV{decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(t),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return eX(this,t)}constructor(t,e,r){if(this.name=t,this.prefix=e,void 0===e.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}}class eW{or(t){return eX(this,t)}decode(t){let e=t[0],r=this.decoders[e];if(r)return r.decode(t);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(t),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}constructor(t){this.decoders=t}}let eX=(t,e)=>new eW({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class eY{encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new eM(t,e,r),this.decoder=new eV(t,e,n)}}let eZ=t=>{let{name:e,prefix:r,encode:n,decode:i}=t;return new eY(e,r,n,i)},eK=t=>{let{prefix:e,name:r,alphabet:n}=t,{encode:i,decode:o}=eD(n,r);return eZ({prefix:e,name:r,encode:i,decode:t=>eq(o(t))})},eG=t=>{let{name:e,prefix:r,bitsPerChar:n,alphabet:i}=t;return eZ({prefix:r,name:e,encode:t=>((t,e,r)=>{let n="="===e[e.length-1],i=(1<<r)-1,o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(t,i,n),decode:t=>((t,e,r,n)=>{let i={};for(let t=0;t<e.length;++t)i[e[t]]=t;let o=t.length;for(;"="===t[o-1];)--o;let s=new Uint8Array(o*r/8|0),a=0,l=0,h=0;for(let e=0;e<o;++e){let o=i[t[e]];if(void 0===o)throw SyntaxError("Non-".concat(n," character"));l=l<<r|o,(a+=r)>=8&&(a-=8,s[h++]=255&l>>a)}if(a>=r||255&l<<8-a)throw SyntaxError("Unexpected end of data");return s})(t,i,n,e)})};var eJ=Object.freeze({__proto__:null,identity:eZ({prefix:"\0",name:"identity",encode:t=>new TextDecoder().decode(t),decode:t=>new TextEncoder().encode(t)})}),eQ=Object.freeze({__proto__:null,base2:eG({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),e$=Object.freeze({__proto__:null,base8:eG({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),e0=Object.freeze({__proto__:null,base10:eK({prefix:"9",name:"base10",alphabet:"0123456789"})}),e1=Object.freeze({__proto__:null,base16:eG({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:eG({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});let e2=eG({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),e8=eG({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),e3=eG({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),e5=eG({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),e6=eG({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),e4=eG({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),e9=eG({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});var e7=Object.freeze({__proto__:null,base32:e2,base32upper:e8,base32pad:e3,base32padupper:e5,base32hex:e6,base32hexupper:e4,base32hexpad:e9,base32hexpadupper:eG({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:eG({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),rt=Object.freeze({__proto__:null,base36:eK({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:eK({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),re=Object.freeze({__proto__:null,base58btc:eK({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:eK({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});let rr=eG({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),rn=eG({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});var ri=Object.freeze({__proto__:null,base64:rr,base64pad:rn,base64url:eG({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:eG({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let ro=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),rs=ro.reduce((t,e,r)=>(t[r]=e,t),[]),ra=ro.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);var rl=Object.freeze({__proto__:null,base256emoji:eZ({prefix:"🚀",name:"base256emoji",encode:function(t){return t.reduce((t,e)=>t+=rs[e],"")},decode:function(t){let e=[];for(let r of t){let t=ra[r.codePointAt(0)];if(void 0===t)throw Error("Non-base256emoji character: ".concat(r));e.push(t)}return new Uint8Array(e)}})});function rh(t,e,r){e=e||[],r=r||0;for(var n=r;t>=0x80000000;)e[r++]=255&t|128,t/=128;for(;-128&t;)e[r++]=255&t|128,t>>>=7;return e[r]=0|t,rh.bytes=r-n+1,e}var rf={encode:rh,encodingLength:function(t){return t<128?1:t<16384?2:t<2097152?3:t<0x10000000?4:t<0x800000000?5:t<0x40000000000?6:t<0x2000000000000?7:t<0x100000000000000?8:t<0x8000000000000000?9:10}};let rc=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return rf.encode(t,e,r),e},ru=t=>rf.encodingLength(t),rd=(t,e)=>{let r=e.byteLength,n=ru(t),i=n+ru(r),o=new Uint8Array(i+r);return rc(t,o,0),rc(r,o,n),o.set(e,i),new rp(t,r,e,o)};class rp{constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}let rg=t=>{let{name:e,code:r,encode:n}=t;return new ry(e,r,n)};class ry{digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?rd(this.code,e):e.then(t=>rd(this.code,t))}throw Error("Unknown type, must be binary type")}constructor(t,e,r){this.name=t,this.code=e,this.encode=r}}let rb=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e));var rw=Object.freeze({__proto__:null,sha256:rg({name:"sha2-256",code:18,encode:rb("SHA-256")}),sha512:rg({name:"sha2-512",code:19,encode:rb("SHA-512")})}),rm=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:eq,digest:t=>rd(0,eq(t))}});new TextEncoder,new TextDecoder;let rE={...eJ,...eQ,...e$,...e0,...e1,...e7,...rt,...re,...ri,...rl};function rx(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}({...rw,...rm}),rx("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),rx("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{let e=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}((t=t.substring(1)).length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),rE.base16,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;"".concat("wc","@").concat(2,":").concat("client",":"),i.THIRTY_DAYS,i.SEVEN_DAYS,i.FIVE_MINUTES,i.FIVE_MINUTES,i.FIVE_MINUTES,i.FIVE_MINUTES,i.FIVE_MINUTES,i.FIVE_MINUTES,i.ONE_DAY,i.ONE_DAY,i.ONE_DAY,i.ONE_DAY,i.FIVE_MINUTES,i.FIVE_MINUTES,i.FIVE_MINUTES,i.FIVE_MINUTES,i.ONE_DAY,i.ONE_DAY,i.ONE_DAY,i.ONE_DAY,i.ONE_HOUR,i.ONE_HOUR,i.FIVE_MINUTES,i.FIVE_MINUTES,i.FIVE_MINUTES,i.SEVEN_DAYS,"".concat("wc","@",1.5,":").concat("auth",":"),Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,t.i(383332),"".concat("wc","@2:").concat("universal_provider",":"),Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var rv=t.i(970422),rO=t.i(93024),rA=t.i(440010),rI=t.i(947366),rS=t.i(591516),rB=t.i(260687),rU=t.i(405784),rC=t.i(982109),rN=t.i(906349),r_=t.i(424756),rP=t.i(921822),rL=t.i(425609);let rj={getSIWX:()=>rN.OptionsController.state.siwx,async initializeIfEnabled(){let t=rN.OptionsController.state.siwx,e=rI.ChainController.getActiveCaipAddress();if(!(t&&e))return;let[r,n,i]=e.split(":");if(rI.ChainController.checkIfSupportedNetwork(r))try{if((await t.getSessions("".concat(r,":").concat(n),i)).length)return;await rC.ModalController.open({view:"SIWXSignMessage"})}catch(t){var o;console.error("SIWXUtil:initializeIfEnabled",t),rU.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await (null==(o=rS.ConnectionController._getClient())?void 0:o.disconnect().catch(console.error)),r_.RouterController.reset("Connect"),rP.SnackController.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){let t=rN.OptionsController.state.siwx,e=rL.CoreHelperUtil.getPlainAddress(rI.ChainController.getActiveCaipAddress()),r=rI.ChainController.getActiveCaipNetwork(),n=rS.ConnectionController._getClient();if(!t)throw Error("SIWX is not enabled");if(!e)throw Error("No ActiveCaipAddress found");if(!r)throw Error("No ActiveCaipNetwork or client found");if(!n)throw Error("No ConnectionController client found");try{let i=await t.createMessage({chainId:r.caipNetworkId,accountAddress:e}),o=i.toString();rB.ConnectorController.getConnectorId(r.chainNamespace)===rv.ConstantsUtil.CONNECTOR_ID.AUTH&&r_.RouterController.pushTransactionStack({});let s=await n.signMessage(o);await t.addSession({data:i,message:o,signature:s}),rC.ModalController.close(),rU.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(e){let t=this.getSIWXEventProperties();rC.ModalController.state.open&&"ApproveTransaction"!==r_.RouterController.state.view||await rC.ModalController.open({view:"SIWXSignMessage"}),t.isSmartAccount?rP.SnackController.showError("This application might not support Smart Accounts"):rP.SnackController.showError("Signature declined"),rU.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:t}),console.error("SWIXUtil:requestSignMessage",e)}},async cancelSignMessage(){try{var t;let e=this.getSIWX();(null==e||null==(t=e.getRequired)?void 0:t.call(e))?await rS.ConnectionController.disconnect():rC.ModalController.close(),r_.RouterController.reset("Connect"),rU.EventsController.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(t){console.error("SIWXUtil:cancelSignMessage",t)}},async getSessions(){let t=rN.OptionsController.state.siwx,e=rL.CoreHelperUtil.getPlainAddress(rI.ChainController.getActiveCaipAddress()),r=rI.ChainController.getActiveCaipNetwork();return t&&e&&r?t.getSessions(r.caipNetworkId,e):[]},async isSIWXCloseDisabled(){let t=this.getSIWX();if(t){let r="ApproveTransaction"===r_.RouterController.state.view,n="SIWXSignMessage"===r_.RouterController.state.view;if(r||n){var e;return(null==(e=t.getRequired)?void 0:e.call(t))&&0===(await this.getSessions()).length}}return!1},async universalProviderAuthenticate(t){var e,r,n;let{universalProvider:i,chains:o,methods:s}=t,a=rj.getSIWX(),l=new Set(o.map(t=>t.split(":")[0]));if(!a||1!==l.size||!l.has("eip155"))return!1;let h=await a.createMessage({chainId:(null==(e=rI.ChainController.getActiveCaipNetwork())?void 0:e.caipNetworkId)||"",accountAddress:""}),f=await i.authenticate({nonce:h.nonce,domain:h.domain,uri:h.uri,exp:h.expirationTime,iat:h.issuedAt,nbf:h.notBefore,requestId:h.requestId,version:h.version,resources:h.resources,statement:h.statement,chainId:h.chainId,methods:s,chains:[h.chainId,...o.filter(t=>t!==h.chainId)]});if(rP.SnackController.showLoading("Authenticating...",{autoClose:!1}),rA.AccountController.setConnectedWalletInfo({...f.session.peer.metadata,name:f.session.peer.metadata.name,icon:null==(r=f.session.peer.metadata.icons)?void 0:r[0],type:"WALLET_CONNECT"},Array.from(l)[0]),null==f||null==(n=f.auths)?void 0:n.length){let t=f.auths.map(t=>{let e=i.client.formatAuthMessage({request:t.p,iss:t.p.iss});return{data:{...t.p,accountAddress:t.p.iss.split(":").slice(-1).join(""),chainId:t.p.iss.split(":").slice(2,4).join(":"),uri:t.p.aud,version:t.p.version||h.version,expirationTime:t.p.exp,issuedAt:t.p.iat,notBefore:t.p.nbf},message:e,signature:t.s.s,cacao:t}});try{await a.setSessions(t),rU.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:rj.getSIWXEventProperties()})}catch(t){throw console.error("SIWX:universalProviderAuth - failed to set sessions",t),rU.EventsController.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:rj.getSIWXEventProperties()}),await i.disconnect().catch(console.error),t}finally{rP.SnackController.hide()}}return!0},getSIWXEventProperties(){var t,e;let r=rI.ChainController.state.activeChain;return{network:(null==(t=rI.ChainController.state.activeCaipNetwork)?void 0:t.caipNetworkId)||"",isSmartAccount:(null==(e=rA.AccountController.state.preferredAccountTypes)?void 0:e[r])===rO.W3mFrameRpcConstants.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){let t=this.getSIWX();t&&await t.setSessions([])}}}]);