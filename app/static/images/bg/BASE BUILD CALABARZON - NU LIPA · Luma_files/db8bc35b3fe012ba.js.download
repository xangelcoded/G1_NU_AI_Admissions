(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,470238,895144,e=>{"use strict";e.s(["CalendarSubmitEventButton",()=>c],470238);var a=e.i(391398),t=e.i(424017),s=e.i(106946),i=e.i(827283),n=e.i(86316),r=e.i(829900),l=e.i(152790),d=e.i(326800),o=e.i(154661);let c=e=>{let{fullWidth:c,size:u="small",hideIcon:m}=e,{user:p}=(0,r.useUserContext)(),{calendar:f,refresh:x,tags:h,is_admin:v}=(0,o.useCalendarContext)(),g=(0,s.useModalState)(),b=(0,s.useModalState)(),y={label:(0,n.useT)()(v?{defaultMessage:"Add Event",id:"XXIgsA",description:"CTA to add an event to a calendar."}:{defaultMessage:"Submit Event",id:"KHoelv",description:"CTA to submit an event to a calendar."}),size:u,fullWidth:c,icon:m?void 0:(0,a.jsx)(i.Plus16Icon,{})};return(0,a.jsxs)(a.Fragment,{children:[p?(0,a.jsx)(d.CalendarAddEventButton,{trigger:(0,a.jsx)(t.LuxButton,{...y,color:"light"}),isAdmin:v,tags:h,calendarApiId:f.api_id,timezone:f.timezone||"local",refreshTags:x,refresh:x}):(0,a.jsx)(t.LuxButton,{...y,color:"light",onClick:b.onShow}),(0,a.jsx)(l.SignInModal,{...b,canClickOutToDismiss:!0,onSignIn:g.onShow})]})};e.s(["calendarLayoutBreakpoint",()=>m,"calendarLayoutBreakpointNumber",()=>p],895144);var u=e.i(405155);let m=u.ResponsiveBreakpoint.medium,p=u.ResponsiveBreakpointNumbers.medium},99887,e=>{"use strict";e.s(["CalendarDateSwitcherDesktop",()=>h,"CalendarMiniCalendar",()=>x]);var a=e.i(391398),t=e.i(359626);e.i(89695);var s=e.i(103800),i=e.i(191788),n=e.i(567120),r=e.i(389612),l=e.i(424017),d=e.i(31197),o=e.i(258715),c=e.i(469891),u=e.i(86316),m=e.i(655794),p=e.i(154661),f=e.i(884885);let x=()=>{let{event_start_ats:e,calendarFilter:n,setCalendarFilter:l,timezone:d}=(0,p.useCalendarContext)(),o=(0,i.useMemo)(()=>e.map(e=>s.DateTime.fromISO(e,{zone:d}).toISODate()),[e,d]),c=(0,i.useRef)(null),u=(0,i.useMemo)(()=>{let a=s.DateTime.now().startOf("day"),t=e.find(e=>s.DateTime.fromISO(e)>=a);if(t)return s.DateTime.fromISO(t,{zone:d})},[]),m=(0,i.useMemo)(()=>{let e=new Set(o);return a=>e.has(a.toISODate())?"dot-visible":"disabled"},[o]),x=(0,i.useCallback)(e=>{var a;null==(a=c.current)||a.scrollTo(e),l(a=>"date"===a.type&&a.year===e.year&&a.month===e.month&&a.day===e.day?{type:a.previousType}:{type:"date",year:e.year,month:e.month,day:e.day,previousType:"date"===a.type?a.previousType:a.type})},[l,c]),h="date"===n.type?n.dt:null;return(0,a.jsxs)("div",{className:"jsx-f33cd24e2745a8a mini-calendar",children:[(0,a.jsx)(r.DatePicker,{selectedDate:h,setDate:x,initialDateShown:u,width:f.calendarSidebarWidth-2-8,ref:c,mode:"dots",getDayType:m}),(0,a.jsx)(t.default,{id:"f33cd24e2745a8a",children:".mini-calendar.jsx-f33cd24e2745a8a{padding:0 4px}"})]})},h=e=>{let{className:i}=e,r=(0,u.useT)(),{calendarFilter:f,setCalendarFilter:x,has_upcoming_events:h}=(0,p.useCalendarContext)(),v="date"===f.type?f.dt.toLocaleString({month:"long",day:"numeric",year:f.dt.hasSame(s.DateTime.now(),"year")?void 0:"numeric"}):null,g=(0,o.usePrevious)(v),b=v||g,y="date"===f.type?f.previousType:f.type;return(0,a.jsxs)("div",{className:"jsx-11506686c0bc57f",children:[(0,a.jsx)(d.LuxCollapse,{show:"date"!==f.type&&h,children:(0,a.jsx)("div",{className:"jsx-11506686c0bc57f "+(i||""),children:(0,a.jsx)("div",{className:"jsx-11506686c0bc57f button-switcher",children:(0,a.jsx)(n.ButtonSwitcher,{smallSizeBreakpoint:"always",value:y,setValue:e=>{x({type:e})},options:[{label:r(m.CT.Upcoming),value:"upcoming"},{label:r(m.CT.Past),value:"past"}]})})})}),(0,a.jsx)(d.LuxCollapse,{show:"date"===f.type,children:(0,a.jsx)("div",{className:"jsx-11506686c0bc57f "+(i||""),children:(0,a.jsxs)("div",{className:"jsx-11506686c0bc57f flex-center spread button-container px-2 py-1",children:[(0,a.jsx)("div",{className:"jsx-11506686c0bc57f fw-medium fs-sm",children:b}),(0,a.jsx)(l.LuxButton,{color:"light",icon:(0,a.jsx)(c.default,{}),label:r(m.CT.Close),iconPlacement:"icon-only-compact",rounded:!0,size:"small",onClick:()=>x(e=>"date"!==e.type?e:{type:e.previousType})})]})})}),(0,a.jsx)(t.default,{id:"11506686c0bc57f",children:".button-switcher.jsx-11506686c0bc57f{padding-top:1px}"})]})}},884885,705542,e=>{"use strict";e.s(["CalendarSidebar",()=>E,"calendarSidebarWidth",()=>M,"useStickyScrollingSidebar",()=>P],884885);var a=e.i(391398),t=e.i(359626),s=e.i(191788),i=e.i(876412),n=e.i(679905),r=e.i(576160),l=e.i(388855),d=e.i(442357),o=e.i(829900),c=e.i(356582),u=e.i(979637),m=e.i(154661),p=e.i(99887),f=e.i(470238),x=e.i(895144);e.s(["MembershipStatusCard",()=>N,"MembershipStatusCardForHeader",()=>A],705542);var h=e.i(272043),v=e.i(766336),g=e.i(173766),b=e.i(512595),y=e.i(860040),j=e.i(405155),_=e.i(225508),w=e.i(922323),C=e.i(86316),T=e.i(262656),L=e.i(619390);let N=e=>{let{className:t}=e,{user:s}=(0,o.useUserContext)(),{calendar:i,membership_info:n}=(0,m.useCalendarContext)();if(!n)return null;let{membership:r,tier:l}=n;return(0,a.jsx)(v.ContentCard,{padding:"0.5rem 0.75rem",className:(0,h.default)("membership-status-card",t),href:d.LumaRoutes.calendar.publicPath({calendar:i,tab:T.Calendar.PublicPageTab.Membership}),children:(0,a.jsx)("div",{className:"membership-card flex-center spread gap-2",children:(0,a.jsxs)("div",{className:"flex-center gap-25",children:[(0,a.jsx)(L.MembershipAvatar,{userAvatarUrl:null==s?void 0:s.avatar_url,tintColor:l.tint_color,rem:2}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"fw-medium fs-sm",children:l.name}),(0,a.jsx)("div",{className:"fs-xs",children:"pending"===r.status?(0,a.jsx)(w.T,{tagName:"div",className:"text-warning",defaultMessage:"Pending Approval",id:"HCSrna",description:"Membership status card. The membership is waiting for admin approval."}):(0,a.jsx)(w.T,{tagName:"div",className:"text-tertiary-alpha",defaultMessage:"Member since {date}",id:"Xzo1Vr",description:"Membership status card. Label for the date the membership was joined.",values:{date:(0,a.jsx)(b.Time,{at:r.created_at,allowRelative:!1,month:"numeric",year:"numeric"},"created_at")}})})]})]})})})},A=()=>{let{calendar:e,membership_info:s}=(0,m.useCalendarContext)(),i=(0,C.useT)(),{is_tiny:r}=(0,y.useWindowSize)();if(!s)return null;let{membership:l,tier:o}=s;return(0,a.jsxs)("div",{className:t.default.dynamic([["ce2f2570aaecd03f",[x.calendarLayoutBreakpoint,j.ResponsiveBreakpoint.tiny]]])+" membership-status-card-header",children:[(0,a.jsx)(n.LuxLink,{href:d.LumaRoutes.calendar.publicPath({calendar:e,tab:T.Calendar.PublicPageTab.Membership}),children:(0,a.jsx)("div",{className:t.default.dynamic([["ce2f2570aaecd03f",[x.calendarLayoutBreakpoint,j.ResponsiveBreakpoint.tiny]]])+" membership-card flex-center spread gap-2",children:(0,a.jsxs)("div",{className:t.default.dynamic([["ce2f2570aaecd03f",[x.calendarLayoutBreakpoint,j.ResponsiveBreakpoint.tiny]]])+" flex-center gap-1",children:[(0,a.jsx)(L.MembershipTierIcon,{tintColor:o.tint_color,rem:r?1.125:1.25}),(0,a.jsxs)("div",{className:t.default.dynamic([["ce2f2570aaecd03f",[x.calendarLayoutBreakpoint,j.ResponsiveBreakpoint.tiny]]]),children:[(0,a.jsx)("span",{className:t.default.dynamic([["ce2f2570aaecd03f",[x.calendarLayoutBreakpoint,j.ResponsiveBreakpoint.tiny]]])+" name mx-1 text-primary text-ellipsis",children:o.name}),"pending"===l.status&&(0,a.jsx)(g.Pill,{label:i({defaultMessage:"Pending",id:"nyc2UD",description:"Membership status card. The membership is waiting for admin approval."}),color:"warning",size:"tiny",rounded:!1})]}),(0,a.jsx)("div",{className:t.default.dynamic([["ce2f2570aaecd03f",[x.calendarLayoutBreakpoint,j.ResponsiveBreakpoint.tiny]]])+" svg-sm text-tertiary-alpha animated",children:(0,a.jsx)(_.ChevronRight16Icon,{})})]})})}),(0,a.jsx)(t.default,{id:"ce2f2570aaecd03f",dynamic:[x.calendarLayoutBreakpoint,j.ResponsiveBreakpoint.tiny],children:".membership-status-card-header.__jsx-style-dynamic-selector{display:none}@media (max-width:".concat(x.calendarLayoutBreakpoint,"){.membership-status-card-header.__jsx-style-dynamic-selector{padding-bottom:1rem;display:block}}.membership-status-card-header.__jsx-style-dynamic-selector .pill{transform:translateY(-1px)}.membership-status-card-header.__jsx-style-dynamic-selector .svg-sm.__jsx-style-dynamic-selector{margin-left:-1px}@media (max-width:").concat(j.ResponsiveBreakpoint.tiny,"){.membership-status-card-header.__jsx-style-dynamic-selector{font-size:var(--font-size-sm)}.membership-status-card-header.__jsx-style-dynamic-selector .pill{transform:translateY(-.5px)}.membership-status-card-header.__jsx-style-dynamic-selector .svg-sm.__jsx-style-dynamic-selector{margin-left:-2px}}.membership-status-card-header.__jsx-style-dynamic-selector .name.__jsx-style-dynamic-selector{max-width:200px}.membership-status-card-header.__jsx-style-dynamic-selector a{background-color:var(--light-button-bg-color);border-radius:100px;padding:.25rem .4375rem;display:inline-block}@media (hover:hover){.membership-status-card-header.__jsx-style-dynamic-selector a:hover{background-color:var(--opacity-second-light)}.membership-status-card-header.__jsx-style-dynamic-selector a:hover .svg-sm.__jsx-style-dynamic-selector{transform:translate(2px)}}")})]})},M=260,k=(0,u.safeDynamic)({loader:()=>e.A(299379).then(e=>e.CalendarMiniMap),fallback:()=>null}),E=()=>{let{calendar:e,has_access:s}=(0,m.useCalendarContext)();return(0,a.jsxs)("div",{className:t.default.dynamic([["4531381efded7acc",[M,x.calendarLayoutBreakpoint]]])+" container",children:[(0,a.jsxs)("div",{className:t.default.dynamic([["4531381efded7acc",[M,x.calendarLayoutBreakpoint]]])+" flex-column gap-3",children:[(0,a.jsx)(N,{}),(0,a.jsxs)("div",{className:t.default.dynamic([["4531381efded7acc",[M,x.calendarLayoutBreakpoint]]])+" flex-center gap-2",children:[(0,a.jsx)(f.CalendarSubmitEventButton,{fullWidth:!0}),s&&(0,a.jsx)(c.AddToWebCalendarButton,{request:{entity:l.IcsApi.Entity.Calendar,id:e.api_id}})]}),(0,a.jsxs)("div",{className:t.default.dynamic([["4531381efded7acc",[M,x.calendarLayoutBreakpoint]]])+" rounded-border",children:[(0,a.jsx)(p.CalendarMiniCalendar,{}),(0,a.jsx)(p.CalendarDateSwitcherDesktop,{className:"px-2 pb-2"})]}),(0,a.jsx)(k,{}),(0,a.jsx)(S,{})]}),(0,a.jsx)(t.default,{id:"4531381efded7acc",dynamic:[M,x.calendarLayoutBreakpoint],children:".container.__jsx-style-dynamic-selector{width:".concat(M,"px}@media (max-width:").concat(x.calendarLayoutBreakpoint,"){.container.__jsx-style-dynamic-selector{display:none}}")})]})},S=()=>{let{calendar:e}=(0,m.useCalendarContext)(),{isSupportAdmin:s}=(0,o.useUserContext)();return s?(0,a.jsxs)("div",{className:"jsx-f2ae8f755f55ac18 admin-container rounded flex-column gap-1 mb-3",children:[(0,a.jsxs)("div",{className:"jsx-f2ae8f755f55ac18 flex-center gap-3 spread",children:[(0,a.jsx)("div",{className:"jsx-f2ae8f755f55ac18 fw-medium text-warning",children:"Admin"}),(0,a.jsxs)("div",{className:"jsx-f2ae8f755f55ac18 flex-center gap-3",children:[(0,a.jsx)(n.LuxLink,{href:d.LumaRoutes.calendar.managePath({calendar:e}),children:"âœï¸"}),(0,a.jsx)(n.LuxLink,{href:r.AdminRoutes.path({type:"calendar",id:e.api_id}),children:"ðŸ“‹"})]})]}),(0,a.jsx)("div",{className:"jsx-f2ae8f755f55ac18 fs-sm text-tertiary-alpha",children:(0,a.jsx)(i.LuxCopy,{text:e.api_id,children:(0,a.jsx)("div",{className:"jsx-f2ae8f755f55ac18 mono",children:e.api_id})})}),(0,a.jsx)(t.default,{id:"f2ae8f755f55ac18",children:".admin-container.jsx-f2ae8f755f55ac18{border:1px solid var(--warning-color);padding:.625rem .875rem}"})]}):null},P=e=>{let{sidebarRef:a}=e;(0,s.useEffect)(()=>{let e=!1,t=()=>{let t=a.current;if(t){if(window.innerWidth<x.calendarLayoutBreakpointNumber){t.style.overflow="hidden";return}if(Math.ceil(window.scrollY)>=t.offsetTop){t.style.overflow="auto";return}t.style.overflow="hidden",e||(e=!0,(e=>{let{element:a,top:t}=e;return new Promise((e,s)=>{if(a.scrollTop===t)return void e();let i=setTimeout(()=>{a.removeEventListener("scroll",n),s()},1e3),n=()=>{a.scrollTop===t&&(clearTimeout(i),a.removeEventListener("scroll",n),e())};a.addEventListener("scroll",n),a.scroll({top:t,behavior:"smooth"})})})({element:t,top:0}).finally(()=>{e=!1}))}};return window.addEventListener("scroll",t),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),window.removeEventListener("scroll",t)}},[a])}},154661,e=>{"use strict";e.s(["CalendarProvider",()=>v,"useCalendarContext",()=>h]);var a=e.i(391398);e.i(89695);var t=e.i(103800),s=e.i(203828),i=e.i(191788),n=e.i(876412),r=e.i(332587),l=e.i(602533),d=e.i(685479),o=e.i(86316),c=e.i(132571),u=e.i(262656),m=e.i(829900),p=e.i(581254),f=e.i(556775);let x=i.default.createContext(null),h=(0,l.createUseAppContext)(x),v=e=>{let{data:l,refresh:h,pathComponents:v,children:g}=e,{user:b}=(0,m.useUserContext)(),y=(0,s.useRouter)(),j=(0,o.useT)(),_="string"==typeof y.query.tag?y.query.tag:null,[w,C]=(0,i.useState)(()=>{if(_){let e=l.tags.find(e=>e.name.toLowerCase()===_.toLowerCase());if(e)return{type:"tag",api_id:e.api_id}}return null}),T=(0,i.useCallback)(e=>{if(C(e),null===e||"tag"!==e.type)(0,d.removeArgFromUrl)("tag");else{let a=l.tags.find(a=>a.api_id===e.api_id);a?(0,d.addArgToUrl)({tag:a.name.toLowerCase()}):(0,d.removeArgFromUrl)("tag")}},[l.tags]),[L,N]=(0,i.useState)(()=>"past"===y.query.period?{type:"past"}:{type:l.has_upcoming_events?"upcoming":"past"});(0,i.useEffect)(()=>{let e={...y.query};"past"===L.type?e.period="past":"upcoming"===L.type&&delete e.period,y.replace({pathname:y.pathname,query:e},void 0,{shallow:!0})},[L.type]);let A=l.calendar.timezone||(0,c.getTimezoneIana)(),M=(0,i.useMemo)(()=>"date"!==L.type?L:{...L,dt:t.DateTime.fromObject({year:L.year,month:L.month,day:L.day},{zone:A})},[L,A]),[k]=v,E=Object.values(u.Calendar.PublicPageTab).find(e=>e===k)||u.Calendar.PublicPageTab.Events,{data:S,refresh:P}=(0,p.useAPI)({path:"/calendar/get-pending-items",args:{calendar_api_id:l.calendar.api_id},pause:!b}),B=(null==S?void 0:S.items)||[],I=(0,i.useCallback)(async()=>{await Promise.all([h(),P()])},[h,P]);return(0,f.useHotkeys)({".":async e=>{e.metaKey&&(e.preventDefault(),await (0,n.copyToClipboard)({text:l.calendar.api_id,t:j,success:j({defaultMessage:"Copied Calendar ID to clipboard. ðŸ“‹",id:"yXhP/S"})}))}}),(0,a.jsx)(x.Provider,{value:{...l,tab:E,tagFilter:w,setTagFilter:T,calendarFilter:M,setCalendarFilter:N,refresh:I,pendingItems:B,is_subscribed:!!(l.calendar_member&&"following"===l.calendar_member.subscribe_status),timezone:A},children:(0,a.jsx)(r.TintWrapper,{tintColor:l.calendar.tint_color,mode:"coming-soon"===l.calendar.launch_status?"brand-color-only":"calendar-page",renderMetaColor:E!==u.Calendar.PublicPageTab.Map&&E!==u.Calendar.PublicPageTab.Membership,children:g})})}},326800,693192,e=>{"use strict";e.s(["CalendarAddEventButton",()=>q],326800);var a=e.i(391398),t=e.i(359626),s=e.i(272043),i=e.i(538865);e.i(89695);var n=e.i(11634),r=e.i(498817),l=e.i(301027),d=e.i(476979),o=e.i(191788),c=e.i(825757),u=e.i(507897),m=e.i(315912),p=e.i(424017),f=e.i(441524),x=e.i(454657),h=e.i(801560),v=e.i(992354),g=e.i(883720),b=e.i(374426),y=e.i(512595),j=e.i(826420),_=e.i(988124),w=e.i(872514),C=e.i(82602),T=e.i(144411),L=e.i(480326),N=e.i(975153),A=e.i(215284),M=e.i(86316),k=e.i(655794),E=e.i(109001),S=e.i(132571),P=e.i(689419),B=e.i(313296),I=e.i(450232),R=e.i(581254);e.s(["TagsInput",()=>O],693192);var D=e.i(715512),U=e.i(461669),z=e.i(194453);let O=e=>{let{value:t,onChange:s,label:i,className:n,pillSize:r="tiny",tags:l,refreshTags:d,...o}=e,c=l.filter(e=>!t.includes(e.api_id)),u=t.flatMap(e=>l.find(a=>a.api_id===e)||[]);return(0,a.jsxs)("div",{className:n,children:[i&&(0,a.jsx)(D.LuxInputLabel,{text:i}),(0,a.jsxs)("div",{className:"flex-center flex-wrap gap-1",children:[(0,a.jsx)(z.BaseTagsDisplay,{tags:u,onDelete:e=>{s(t.filter(a=>a!==e))},size:r}),(0,a.jsx)(U.AddTagDropdown,{...o,addableTags:c,size:r,variant:"light",entityApiIds:[],onApply:async e=>{let{tagApiId:a,newTagCreated:i}=e;i&&await d(),s([...t,a])}})]})]})};var W=e.i(581455),F=e.i(348688);let q=e=>{let{trigger:t,...s}=e,i=(0,j.useBoolean)(),[n,r]=(0,o.useState)(null),l=(0,M.useT)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.LuxMenu,{trigger:(0,a.jsx)("div",{className:"full-width",children:t}),open:i.value,setOpen:i.setValue,placement:"bottom",minWidth:222,rows:[{key:"new",icon:(0,a.jsx)(A.default,{}),name:l({defaultMessage:"Create New Event",id:"T44eXr",description:"CTA to create a new event."}),href:"/create?".concat(d.default.stringify({calendar:s.calendarApiId}))},{key:"luma",icon:(0,a.jsx)(T.default,{}),name:l(s.isAdmin?{defaultMessage:"Add Existing Luma Event",id:"RNJZS7",description:"CTA to add an existing Luma event to a calendar."}:{defaultMessage:"Submit Existing Luma Event",id:"rJtBqP",description:"CTA to submit an existing Luma event to a calendar."}),onClick:()=>{r("luma")}},{key:"external",icon:(0,a.jsx)(L.default,{}),name:l(s.isAdmin?{defaultMessage:"Add External Event",id:"HwmiKO",description:"CTA to add an external event to a calendar."}:{defaultMessage:"Submit External Event",id:"D5kUJB",description:"CTA to submit an external event to a calendar."}),onClick:()=>{r("external")}}]}),(0,a.jsx)(V,{...s,show:"luma"===n,onHide:()=>{r(null)}}),(0,a.jsx)(J,{...s,show:"external"===n,onHide:()=>{r(null)}})]})},H=e=>{let{t:a,success:t,count:s,isAdmin:i}=e;return t?a(i?{defaultMessage:"{count, plural, one {Event} other {Events}} added successfully!",id:"Tq2VFY",description:"Success message for adding event to calendar."}:{defaultMessage:"{count, plural, one {Event} other {Events}} submitted successfully!",id:"zcdRqE",description:"Success message for submitting event to calendar."},{count:s}):a({defaultMessage:"We encountered an error processing this request.",id:"tOU01e",description:"Error message for adding event to calendar."})},V=e=>{let{show:t,onHide:s,...i}=e,n=(0,M.useT)();return(0,a.jsx)(v.LuxModalContainer,{onHide:s,title:n(i.isAdmin?{defaultMessage:"Add Luma Event",id:"vVZksN",description:"Title for adding an existing Luma event to a calendar."}:{defaultMessage:"Submit Luma Event",id:"Y5xgWO",description:"Title for submitting an existing Luma event to a calendar."}),variant:"compact",children:t&&(0,a.jsx)(X,{onHide:s,...i})})},X=e=>{let{onHide:i,...n}=e,d=(0,M.useT)(),c=o.default.useRef(null),u=n.tags.length>0||n.isAdmin,[m,f]=(0,o.useState)([]),[h,v]=(0,o.useState)(""),[g,b]=(0,o.useState)([]),y=n.isAdmin?d({defaultMessage:"Add {count, plural, one {Event} other {# Events}}",id:"aetDu2",description:"Label for add event button."},{count:m.length||1}):d({defaultMessage:"Submit {count, plural, one {Event} other {# Events}}",id:"df7UhD",description:"Label for submit event button."},{count:m.length||1}),j=async e=>{try{var a,t;let s=null!=(a=null==e?void 0:e.inputText)?a:h,i=s.startsWith("http"),r=new URL(i?s:"https://".concat(s)),l=r.host.toLowerCase();if(W.config.WEB_URLS.some(e=>{let a=new URL(e).host.toLowerCase();return l===a})){let a=null;if(r.pathname.startsWith("/event/manage/")){let e=r.pathname.slice(14);e&&(a={event_api_id:e,type:"calendar",calendar_api_id:n.calendarApiId})}else{let e=r.pathname.split("/")[1];e&&(a={url:e,type:"calendar",calendar_api_id:n.calendarApiId})}if(a){let{event:e,validation:s}=await F.APIClient.get("/discover/get-event-for-submission",a);s.can_submit?m.find(a=>a.api_id===e.api_id)?(0,C.toastError)(d({defaultMessage:"This event has already been added to the calendar.",id:"7Wydji"})):(v(""),f([...m,e]),null==(t=c.current)||t.focus()):(0,C.toastError)(d({defaultMessage:"This event cannot be submitted to this calendar.",id:"oEQ4sj"}))}else(null==e?void 0:e.suppressToast)||(0,C.toastError)(d({defaultMessage:"Please enter a valid Luma event URL.",id:"O/R9zJ"}))}}catch(t){console.error(t);let a=t instanceof E.FetchError?t.message:d({defaultMessage:"Please enter a valid Luma event URL.",id:"O/R9zJ"});(null==e?void 0:e.suppressToast)||(0,C.toastError)(a)}};return(0,a.jsxs)("div",{className:"jsx-29044a092d2225b flex-column gap-3",children:[m.length>0&&(0,a.jsx)(Y,{events:m,onRemove:e=>{f(m.filter(a=>a.api_id!==e.api_id))}}),(0,a.jsx)(r.AnimatePresence,{initial:!1,children:m.length<10&&(0,a.jsxs)(l.m.div,{className:"add-luma-event-input-wrapper relative",...w.MOTION_VERTICAL_EXPAND_TRANSITION,children:[(0,a.jsx)(x.LuxInput,{placeholder:d({defaultMessage:"Enter Luma Event URL",id:"vpvqUM",description:"Label for input to enter a Luma event link"}),value:h,onChange:v,ref:c,type:"url",autoFocus:!0,inputProps:{onKeyDown:e=>{"Enter"===e.key&&(0,P.isValidUrl)(h)&&(e.preventDefault(),j())},onPaste:async e=>{let a=e.clipboardData.getData("text").trim();if(a&&(0,P.isValidUrl)(a))try{let t=a.startsWith("http"),s=new URL(t?a:"https://".concat(a)).host.toLowerCase();W.config.WEB_URLS.some(e=>s===new URL(e).host.toLowerCase())&&(e.preventDefault(),v(a),j({inputText:a,suppressToast:!0}))}catch(e){}}}}),(0,a.jsx)(p.LuxButton,{className:(0,s.default)("input-add-button",{show:(0,P.isValidUrl)(h)}),icon:(0,a.jsx)(A.default,{}),label:d(k.CT.Add),size:"small",variant:"naked",onClick:()=>j()})]})}),(0,a.jsx)(K,{calendar_api_id:n.calendarApiId,exclude_event_api_ids:m.map(e=>e.api_id),onSubmit:e=>{f([...m,e])}}),u&&(0,a.jsx)(O,{pillSize:"small",tags:n.tags,refreshTags:n.refreshTags,allowCreate:n.isAdmin,tagBase:{entity_type:"calendar_event",owner_api_id:n.calendarApiId,owner_type:"calendar"},onChange:e=>b(e),value:g,variant:"light"}),(0,a.jsx)(p.LuxButton,{fullWidth:!0,className:u?"":"mt-1",disabled:0===m.length,label:y,onClick:async()=>{let{error:e}=await (0,_.callWithToast)(async()=>{await F.APIClient.post("/calendar/submit-event",{platform:"luma",calendar_api_id:n.calendarApiId,tag_api_ids:g,event_api_ids:m.map(e=>e.api_id)}),await n.refresh()},{success:H({t:d,success:!0,count:m.length,isAdmin:n.isAdmin}),error:H({t:d,success:!1,count:m.length,isAdmin:n.isAdmin})});e||i()}}),(0,a.jsx)(t.default,{id:"29044a092d2225b",children:".add-luma-event-input-wrapper .input-add-button{border-radius:var(--small-border-radius);position:absolute;top:.25rem;right:.25rem}.add-luma-event-input-wrapper .input-add-button:not(.show){opacity:0;pointer-events:none}.add-luma-event-input-wrapper input.lux-input{padding-right:4.5rem}"})]})},Y=e=>{let{events:s,onRemove:i}=e,n=(0,M.useT)();return(0,a.jsxs)(m.ListCard,{children:[(0,a.jsx)(r.AnimatePresence,{children:s.map(e=>(0,a.jsx)(l.m.div,{className:"added-event-row",...w.MOTION_VERTICAL_EXPAND_TRANSITION,children:(0,a.jsx)(m.BaseListRow,{children:(0,a.jsxs)("div",{className:"jsx-95f3f9ba20930fb5 flex-center spread",children:[(0,a.jsxs)("div",{className:"jsx-95f3f9ba20930fb5 flex-center gap-2",children:[(0,a.jsx)(u.FixedSizeImage,{className:"mr-1",shape:"rounded-small",src:e.cover_url,width:36,height:36}),(0,a.jsxs)("div",{className:"jsx-95f3f9ba20930fb5 reduced-line-height",children:[(0,a.jsx)("div",{className:"jsx-95f3f9ba20930fb5",children:e.name}),(0,a.jsx)("div",{className:"jsx-95f3f9ba20930fb5 text-tertiary-alpha fs-xs mt-1",children:(0,a.jsx)(y.Time,{at:e.start_at,month:"short",day:"numeric",hour:"numeric",minute:"numeric",year:"only-if-different"})})]})]}),(0,a.jsx)(p.LuxButton,{icon:(0,a.jsx)(N.default,{}),iconPlacement:"icon-only-compact",label:n(k.CT.Remove),color:"light",size:"small",onClick:()=>{i(e)}})]})})},e.api_id))}),(0,a.jsx)(t.default,{id:"95f3f9ba20930fb5",children:'.added-event-row{position:relative}.added-event-row+.added-event-row:before{content:"";background-color:var(--table-border-color);width:100%;height:1px;top:-.5px;left:var(--base-list-divider-left-offset);display:block;position:absolute}'})]})},K=e=>{let{calendar_api_id:s,exclude_event_api_ids:i,onSubmit:n}=e,d=(0,M.useT)(),{data:o}=(0,R.useAPI)({path:"/calendar/get-events-to-submit",args:{calendar_api_id:s}}),c=null==o?void 0:o.events.filter(e=>!(null==i?void 0:i.includes(e.api_id)));return c&&0!==c.length?(0,a.jsxs)("div",{className:"jsx-8b182bf8e9f18e49 suggested-card",children:[(0,a.jsx)("div",{className:"jsx-8b182bf8e9f18e49 mb-1 fs-xs fw-medium text-tertiary-alpha",children:d({defaultMessage:"Suggested Events",id:"/y822q",description:"Label for a list of suggested events."})}),(0,a.jsx)(r.AnimatePresence,{initial:!1,children:c.map(e=>(0,a.jsx)(l.m.div,{...w.MOTION_VERTICAL_EXPAND_TRANSITION,children:(0,a.jsxs)("div",{className:"jsx-8b182bf8e9f18e49 flex-center spread row gap-2",children:[(0,a.jsx)(u.FixedSizeImage,{className:"mr-05",src:e.cover_url,width:20,height:20,shape:"rounded-small"}),(0,a.jsxs)("div",{className:"jsx-8b182bf8e9f18e49 fs-sm text-ellipses flex-1",children:[(0,a.jsx)("span",{className:"jsx-8b182bf8e9f18e49",children:e.name}),(0,a.jsx)("span",{className:"jsx-8b182bf8e9f18e49",children:"Â Â "}),(0,a.jsx)("span",{className:"jsx-8b182bf8e9f18e49 text-tertiary-alpha",children:(0,a.jsx)(y.Time,{at:e.start_at,month:"short",day:"numeric",hour:"numeric",minute:"numeric",year:"only-if-different"})})]}),(0,a.jsx)(p.LuxButton,{label:d(k.CT.Add),icon:(0,a.jsx)(A.default,{}),iconPlacement:"icon-only-compact",variant:"naked",onClick:()=>{n(e)},color:"secondary",size:"small"})]})},e.api_id))}),(0,a.jsx)(t.default,{id:"8b182bf8e9f18e49",children:".suggested-card.jsx-8b182bf8e9f18e49{border-radius:var(--card-border-radius);border:2px dashed var(--divider-color);padding:.5rem .5rem .625rem .75rem}.row.jsx-8b182bf8e9f18e49{padding-top:.5625rem}"})]}):null},J=e=>{let{show:t,onHide:s,...r}=e,l=(0,M.useT)(),{isAdmin:d,calendarApiId:u,tags:m,timezone:p,refresh:f,refreshTags:h}=r,b=o.default.useRef(null);return(0,a.jsx)(v.LuxModalContainer,{onHide:s,title:r.isAdmin?l({defaultMessage:"Add External Event",id:"PArBjd",description:"Title for adding an external event to a calendar."}):l({defaultMessage:"Submit External Event",id:"MhHIcD",description:"Title for submitting an external event to a calendar."}),children:t&&(0,a.jsx)(i.Formik,{initialValues:{name:"",host:"",timezone:"local"===p?(0,S.getTimezoneIana)():p,url:"",tag_api_ids:[],geo_address_json:null,coordinate:null,start_at:(0,B.roundedTime)({intervalMin:60}),duration_interval:n.Duration.fromObject({hour:1}).toISO()},onSubmit:async e=>{let{host:a,name:t,geo_address_json:i,coordinate:n,tag_api_ids:r,url:o,duration_interval:c,timezone:m,start_at:p}=e;await (0,_.callWithToast)(async()=>{await F.APIClient.post("/calendar/submit-event",{platform:"external",calendar_api_id:u,name:t,url:o,tag_api_ids:r,start_at:p,host:a,geo_address_json:i,coordinate:n,timezone:m,duration_interval:c}),await f(),s()},{success:H({t:l,success:!0,count:1,isAdmin:d}),error:H({t:l,success:!1,count:1,isAdmin:d})})},children:e=>{let{values:t,setFieldValue:s}=e;return(0,a.jsxs)(i.Form,{className:"flex-column gap-25",children:[(0,a.jsx)(Q,{name:"url",onParse:e=>{for(let a of["start_at","duration_interval","name","host","geo_address_json","coordinate"])e[a]&&s(a,e[a])},ref:b}),(0,a.jsx)(x.LuxInputField,{name:"name",label:l({defaultMessage:"Event Name *",description:"Label for input for event name. * means required.",id:"EPNCM7"}),required:!0,suppress1Password:!0,placeholder:l({defaultMessage:"Happy Hour Drinks",id:"9cTxfQ",description:"Placeholder for event name input. Use what makes sense as event name."})}),(0,a.jsx)(I.EditOfflineLocation,{geo_address_json:t.geo_address_json,coordinate:t.coordinate,timezone:t.timezone,maxWidth:"100%",suppressInstructions:!0,updateInfo:e=>{let{timezone:a,coordinate:i,geo_address_json:n}=e;s("timezone",null!=a?a:t.timezone),s("coordinate",i),s("geo_address_json",n)}}),(0,a.jsx)(x.LuxInputField,{name:"host",label:l({defaultMessage:"Host",id:"G2/ViS",description:"Label for input for event host."}),placeholder:l({defaultMessage:"Friends of the City",id:"WIhwNs",description:"Placeholder for event host input. Use what makes sense as a host."})}),(0,a.jsx)(c.DateTimeRangeField,{label:l({defaultMessage:"Event Time",id:"i+hUcG",description:"Label for event time input."}),values:t,setFieldValue:s}),!!(m.length>0||d)&&(0,a.jsx)(O,{className:"my-1",pillSize:"small",tags:m,refreshTags:h,allowCreate:d,tagBase:{entity_type:"calendar_event",owner_api_id:u,owner_type:"calendar"},onChange:e=>s("tag_api_ids",e),value:t.tag_api_ids,variant:"light"}),(0,a.jsx)(g.LuxSubmitButton,{fullWidth:!0,className:m.length>0||d?"":"mt-1",label:d?l({defaultMessage:"Add Event",id:"YlWqY2",description:"Label for add event button."}):l({defaultMessage:"Submit Event",id:"NTNwwy",description:"Label for submit event button."})})]})}})})},Q=(0,o.forwardRef)((e,s)=>{let{name:n,onParse:r}=e,{setFieldValue:l}=(0,i.useFormikContext)(),d=(0,j.useBoolean)(),o=(0,M.useT)();return(0,a.jsxs)("div",{className:"jsx-eae1b6274898abc7 relative",children:[(0,a.jsx)(x.LuxInputField,{name:n,label:o({defaultMessage:"Event Page URL *",id:"oyZxMu",description:"Label for input for event page URL. * means required."}),type:"url",ref:s,required:!0,autoFocus:!0,placeholder:"https://eventbrite.com/e/some-event",onChange:async e=>{let a=e.trim();if(l("url",a),a){try{new URL(a)}catch(e){return}d.setTrue();try{let{parsed:e}=await F.APIClient.get("/external-event/parse-url",{url:a});r(e)}finally{d.setFalse()}}}}),(0,a.jsx)(f.LuxFade,{show:d.value,children:(0,a.jsxs)("div",{className:"jsx-eae1b6274898abc7 parse-wrapper flex-center gap-1 text-tertiary-alpha fs-sm svg-sm",children:[(0,a.jsx)(b.Spinner,{}),(0,a.jsx)("div",{className:"jsx-eae1b6274898abc7",children:o({defaultMessage:"Parsing URL...",id:"aP2Q3g",description:"Message indicating we are parsing a URL submitted by the user."})})]})}),(0,a.jsx)(t.default,{id:"eae1b6274898abc7",children:".parse-wrapper.jsx-eae1b6274898abc7{position:absolute;top:0;right:0}"})]})})}]);